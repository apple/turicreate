get_filename_component(MINGW_PATH "@MINGW_GFORTRAN@" PATH)
if(NOT EXISTS "${MINGW_PATH}")
  set(test_exe
    "@VSGNUFortran_BINARY_DIR@/bin/c_using_fortran@CMAKE_EXECUTABLE_SUFFIX@")
  message("run: ${test_exe}")
  execute_process(COMMAND "${test_exe}"
    RESULT_VARIABLE res)
  if(NOT "${res}" EQUAL 0)
    message(FATAL_ERROR "${test_exe} returned a non 0 value")
  endif()
  return()
endif()
file(TO_NATIVE_PATH "${MINGW_PATH}" MINGW_PATH)
string(REPLACE "\\" "\\\\" MINGW_PATH "${MINGW_PATH}")
message("${MINGW_PATH}")
set(test_exe "@VSGNUFortran_BINARY_DIR@/bin/c_using_fortran.exe")
set(ENV{PATH} "${MINGW_PATH};$ENV{PATH}")
message("run ${test_exe}")
execute_process(COMMAND "${test_exe}"
  RESULT_VARIABLE res)
if(NOT "${res}" EQUAL 0)
  message(FATAL_ERROR "${test_exe} returned a non 0 value")
endif()
