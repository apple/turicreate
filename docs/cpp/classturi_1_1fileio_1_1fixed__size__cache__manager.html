<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.11"/>
<title>Turi Create: turi::fileio::fixed_size_cache_manager Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Turi Create
   &#160;<span id="projectnumber">4.0</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.11 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li class="current"><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li><a href="examples.html"><span>Examples</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="annotated.html"><span>Class&#160;List</span></a></li>
      <li><a href="classes.html"><span>Class&#160;Index</span></a></li>
      <li><a href="hierarchy.html"><span>Class&#160;Hierarchy</span></a></li>
      <li><a href="functions.html"><span>Class&#160;Members</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('classturi_1_1fileio_1_1fixed__size__cache__manager.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="classturi_1_1fileio_1_1fixed__size__cache__manager-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">turi::fileio::fixed_size_cache_manager Class Reference<div class="ingroups"><a class="el" href="group__fileio.html">File IO Library</a></div></div>  </div>
</div><!--header-->
<div class="contents">

<p><code>#include &lt;<a class="el" href="fixed__size__cache__manager_8hpp_source.html">fileio/fixed_size_cache_manager.hpp</a>&gt;</code></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a3712ce7da3aaca78394db7a9b012ce2f"><td class="memItemLeft" align="right" valign="top">cache_id_type&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classturi_1_1fileio_1_1fixed__size__cache__manager.html#a3712ce7da3aaca78394db7a9b012ce2f">get_temp_cache_id</a> (std::string suffix=&quot;&quot;)</td></tr>
<tr class="separator:a3712ce7da3aaca78394db7a9b012ce2f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6e2255c83e4d64e15ad346188922fe02"><td class="memItemLeft" align="right" valign="top">std::shared_ptr&lt; <a class="el" href="structturi_1_1fileio_1_1cache__block.html">cache_block</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classturi_1_1fileio_1_1fixed__size__cache__manager.html#a6e2255c83e4d64e15ad346188922fe02">new_cache</a> (cache_id_type cache_id)</td></tr>
<tr class="separator:a6e2255c83e4d64e15ad346188922fe02"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a215e46aa659b234501ffc3f7a5eedba8"><td class="memItemLeft" align="right" valign="top">std::shared_ptr&lt; <a class="el" href="structturi_1_1fileio_1_1cache__block.html">cache_block</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classturi_1_1fileio_1_1fixed__size__cache__manager.html#a215e46aa659b234501ffc3f7a5eedba8">get_cache</a> (cache_id_type cache_id)</td></tr>
<tr class="separator:a215e46aa659b234501ffc3f7a5eedba8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa407c44076a86f0f3137bf08db95a59b"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classturi_1_1fileio_1_1fixed__size__cache__manager.html#aa407c44076a86f0f3137bf08db95a59b">free</a> (std::shared_ptr&lt; <a class="el" href="structturi_1_1fileio_1_1cache__block.html">cache_block</a> &gt; block)</td></tr>
<tr class="separator:aa407c44076a86f0f3137bf08db95a59b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adaa2db4b6c4d13f13bb0d7582a0ec13b"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classturi_1_1fileio_1_1fixed__size__cache__manager.html#adaa2db4b6c4d13f13bb0d7582a0ec13b">clear</a> ()</td></tr>
<tr class="separator:adaa2db4b6c4d13f13bb0d7582a0ec13b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aeb9270b5aa0bd67e7f18d545c5e8ff55"><td class="memItemLeft" align="right" valign="top">size_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classturi_1_1fileio_1_1fixed__size__cache__manager.html#aeb9270b5aa0bd67e7f18d545c5e8ff55">get_cache_utilization</a> ()</td></tr>
<tr class="separator:aeb9270b5aa0bd67e7f18d545c5e8ff55"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>A global singleton object managing the allocation/deallocation of cache blocks. The basic mechanism of operation is such:</p>
<ul>
<li>For every new cache block requested:<ul>
<li>If there is FILEIO_MAXIMUM_CACHE_CAPACITY_PER_FILE free bytes, a new cache block of FILEIO_INITIAL_CAPACITY_PER_FILE is allocated, where the new cache block is permitted to grow up to FILEIO_MAXIMUM_CACHE_CAPACITY_PER_FILE. The capacity is not charged as utilization until it is actually used. i.e. utilization is only incremented by FILEIO_INITIAL_CACHE_CAPACITY_PER_FILE. Then as more memory is allocated for the cache, then utilization is incremented again.</li>
<li>If there is &lt; FILEIO_MAXIMUM_CACHE_CAPACITY_PER_FILE free bytes available: The largest cache block is evicted. If there is FILEIO_MAXIMUM_CACHE_CAPACITY_PER_FILE free bytes, Goto the first case. Otherwise, create a new cache block with all the remaining free bytes.</li>
</ul>
</li>
</ul>
<p>The relevant constants are thus: FILEIO_MAXIMUM_CACHE_CAPACITY : the maximum total size of all cache blocks FILEIO_MAXIMUM_CACHE_CAPACITY_PER_FILE : the maximum size of each cache blocks FILEIO_INITIAL_CAPACITY_PER_FILE : the initial size of each cache blocks</p>
<h2>Overcommit Behavior </h2>
<p>We try our best to maintain cache utilization below the maximum. However, it is possible to exceed maximum cache utilization under certain race conditions since we avoid locking on the cache utilization counter. </p>

<p>Definition at line <a class="el" href="fixed__size__cache__manager_8hpp_source.html#l00194">194</a> of file <a class="el" href="fixed__size__cache__manager_8hpp_source.html">fixed_size_cache_manager.hpp</a>.</p>
</div><h2 class="groupheader">Member Function Documentation</h2>
<a class="anchor" id="adaa2db4b6c4d13f13bb0d7582a0ec13b"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void turi::fileio::fixed_size_cache_manager::clear </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Clear all cache blocks in the manager. Reset to initial state. </p>

</div>
</div>
<a class="anchor" id="aa407c44076a86f0f3137bf08db95a59b"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void turi::fileio::fixed_size_cache_manager::free </td>
          <td>(</td>
          <td class="paramtype">std::shared_ptr&lt; <a class="el" href="structturi_1_1fileio_1_1cache__block.html">cache_block</a> &gt;&#160;</td>
          <td class="paramname"><em>block</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Free the data in the cache block. Delete the allocated memory or temp file associated with the cache.</p>
<p>NOT thread safe to call on the same block. </p>

</div>
</div>
<a class="anchor" id="a215e46aa659b234501ffc3f7a5eedba8"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::shared_ptr&lt;<a class="el" href="structturi_1_1fileio_1_1cache__block.html">cache_block</a>&gt; turi::fileio::fixed_size_cache_manager::get_cache </td>
          <td>(</td>
          <td class="paramtype">cache_id_type&#160;</td>
          <td class="paramname"><em>cache_id</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Returns the pointer to the <a class="el" href="structturi_1_1fileio_1_1cache__block.html">cache_block</a> assocaited with the cache_id, Throws std::out_of_range if the cache_id does not exist.</p>
<p>Thread safe. </p>

</div>
</div>
<a class="anchor" id="aeb9270b5aa0bd67e7f18d545c5e8ff55"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">size_t turi::fileio::fixed_size_cache_manager::get_cache_utilization </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Returns the amount of memory being used by the caches. </p>

<p>Definition at line <a class="el" href="fixed__size__cache__manager_8hpp_source.html#l00239">239</a> of file <a class="el" href="fixed__size__cache__manager_8hpp_source.html">fixed_size_cache_manager.hpp</a>.</p>

</div>
</div>
<a class="anchor" id="a3712ce7da3aaca78394db7a9b012ce2f"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">cache_id_type turi::fileio::fixed_size_cache_manager::get_temp_cache_id </td>
          <td>(</td>
          <td class="paramtype">std::string&#160;</td>
          <td class="paramname"><em>suffix</em> = <code>&quot;&quot;</code></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Returns a temporary cache id that is not yet used by the manager. </p>

</div>
</div>
<a class="anchor" id="a6e2255c83e4d64e15ad346188922fe02"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::shared_ptr&lt;<a class="el" href="structturi_1_1fileio_1_1cache__block.html">cache_block</a>&gt; turi::fileio::fixed_size_cache_manager::new_cache </td>
          <td>(</td>
          <td class="paramtype">cache_id_type&#160;</td>
          <td class="paramname"><em>cache_id</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Allocate a new cache block of up to some maximum capcity. If the cache_id already exists, the data will be lost.</p>
<p>Returns a pointer to the cache block. Thread safe. </p>

</div>
</div>
<hr/>The documentation for this class was generated from the following file:<ul>
<li>fileio/<a class="el" href="fixed__size__cache__manager_8hpp_source.html">fixed_size_cache_manager.hpp</a></li>
</ul>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="namespaceturi.html">turi</a></li><li class="navelem"><b>fileio</b></li><li class="navelem"><a class="el" href="classturi_1_1fileio_1_1fixed__size__cache__manager.html">fixed_size_cache_manager</a></li>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.11 </li>
  </ul>
</div>
</body>
</html>
