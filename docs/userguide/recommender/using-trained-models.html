
<!DOCTYPE HTML>
<html lang="" >
    <head>
        <title>Using models Â· GitBook</title>
        <meta charset="UTF-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta name="description" content="">
        <meta name="generator" content="GitBook 3.2.0">
        
        
        
    
    <link rel="stylesheet" href="../gitbook/style.css">

    
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-anchors/plugin.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-highlight/website.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-search/search.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-fontsettings/website.css">
                
            
        

    

    
        
    
        
    
        
    
        
    
        
    
        
    

        
    
    
    
    <meta name="HandheldFriendly" content="true"/>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <link rel="apple-touch-icon-precomposed" sizes="152x152" href="../gitbook/images/apple-touch-icon-precomposed-152.png">
    <link rel="shortcut icon" href="../gitbook/images/favicon.ico" type="image/x-icon">

    
    <link rel="next" href="choosing-a-model.html" />
    
    
    <link rel="prev" href="./" />
    

    <script src="../turi/js/jquery/jquery-2.1.3.min.js"></script>
    <script src="../turi/js/d3/d3.min.js"></script>
    <script src="../supervised-learning/images/random-utils.js"></script>
    <script src="../supervised-learning/images/plotting-utils.js"></script>

    </head>
    <body>
        
<div class="book">
    <div class="book-summary">
        
            
<div id="book-search-input" role="search">
    <input type="text" placeholder="Type to search" />
</div>

            
                <nav role="navigation">
                


<ul class="summary">
    
    

    

    
        
        
    
        <li class="chapter " data-level="1.1" data-path="../">
            
                <a href="../">
            
                    
                    Overview
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2" data-path="../sframe/">
            
                <a href="../sframe/">
            
                    
                    Working with data
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.2.1" data-path="../sframe/tabular-data.html">
            
                <a href="../sframe/tabular-data.html">
            
                    
                    Tabular data
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.2.1.1" data-path="../sframe/sframe-intro.html">
            
                <a href="../sframe/sframe-intro.html">
            
                    
                    Loading and Saving
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.1.2" data-path="../sframe/data-manipulation.html">
            
                <a href="../sframe/data-manipulation.html">
            
                    
                    Data Manipulation
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.1.3" data-path="../data_formats_and_sources/sql_integration.html">
            
                <a href="../data_formats_and_sources/sql_integration.html">
            
                    
                    SQL Databases
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.2.2" data-path="../sgraph/sgraph.html">
            
                <a href="../sgraph/sgraph.html">
            
                    
                    Graph data
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.3" data-path="../text/analysis.html">
            
                <a href="../text/analysis.html">
            
                    
                    Text data
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.4" data-path="../vis/">
            
                <a href="../vis/">
            
                    
                    Visualization
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.2.4.1" data-path="../vis/gallery.html">
            
                <a href="../vis/gallery.html">
            
                    
                    Example Gallery
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.4.2" data-path="../vis/use_cases.html">
            
                <a href="../vis/use_cases.html">
            
                    
                    Sample Use Cases
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.3" data-path="../applications/">
            
                <a href="../applications/">
            
                    
                    Task focused toolkits
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.3.1" data-path="./">
            
                <a href="./">
            
                    
                    Recommender Systems
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter active" data-level="1.3.1.1" data-path="using-trained-models.html">
            
                <a href="using-trained-models.html">
            
                    
                    Using models
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.1.2" data-path="choosing-a-model.html">
            
                <a href="choosing-a-model.html">
            
                    
                    Choosing a model
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.1.3" data-path="coreml-deployment.html">
            
                <a href="coreml-deployment.html">
            
                    
                    Deployment to Core ML
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.3.2" data-path="../image_classifier/">
            
                <a href="../image_classifier/">
            
                    
                    Image Classification
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.3.2.1" data-path="../image_classifier/advanced-usage.html">
            
                <a href="../image_classifier/advanced-usage.html">
            
                    
                    Advanced Usage
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.2.2" data-path="../image_classifier/how-it-works.html">
            
                <a href="../image_classifier/how-it-works.html">
            
                    
                    How it works
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.2.3" data-path="../image_classifier/export-coreml.html">
            
                <a href="../image_classifier/export-coreml.html">
            
                    
                    Deployment to Core ML
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.3.3" data-path="../drawing_classifier/">
            
                <a href="../drawing_classifier/">
            
                    
                    Drawing Classification
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.3.3.1" data-path="../drawing_classifier/how-it-works.html">
            
                <a href="../drawing_classifier/how-it-works.html">
            
                    
                    How it works
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.3.2" data-path="../drawing_classifier/data-preparation.html">
            
                <a href="../drawing_classifier/data-preparation.html">
            
                    
                    Data Preparation
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.3.3" data-path="../drawing_classifier/export-coreml.html">
            
                <a href="../drawing_classifier/export-coreml.html">
            
                    
                    Deployment to Core ML
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.3.4" data-path="../drawing_classifier/advanced-usage.html">
            
                <a href="../drawing_classifier/advanced-usage.html">
            
                    
                    Advanced Usage
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.3.4" data-path="../sound_classifier/">
            
                <a href="../sound_classifier/">
            
                    
                    Sound Classification
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.3.4.1" data-path="../sound_classifier/how-it-works.html">
            
                <a href="../sound_classifier/how-it-works.html">
            
                    
                    How it works
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.4.2" data-path="../sound_classifier/advanced-usage.html">
            
                <a href="../sound_classifier/advanced-usage.html">
            
                    
                    Advanced Usage
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.4.3" data-path="../sound_classifier/export-coreml.html">
            
                <a href="../sound_classifier/export-coreml.html">
            
                    
                    Deployment to Core ML
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.3.5" data-path="../image_similarity/">
            
                <a href="../image_similarity/">
            
                    
                    Image Similarity
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.3.5.1" data-path="../image_similarity/export-coreml.html">
            
                <a href="../image_similarity/export-coreml.html">
            
                    
                    Deployment to Core ML
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.3.6" data-path="../object_detection/">
            
                <a href="../object_detection/">
            
                    
                    Object Detection
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.3.6.1" data-path="../object_detection/data-preparation.html">
            
                <a href="../object_detection/data-preparation.html">
            
                    
                    Data Preparation
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.6.2" data-path="../object_detection/advanced-usage.html">
            
                <a href="../object_detection/advanced-usage.html">
            
                    
                    Advanced Usage
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.6.3" data-path="../object_detection/export-coreml.html">
            
                <a href="../object_detection/export-coreml.html">
            
                    
                    Deployment to Core ML
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.6.4" data-path="../object_detection/how-it-works.html">
            
                <a href="../object_detection/how-it-works.html">
            
                    
                    How it works
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.3.7" data-path="../one_shot_object_detection/">
            
                <a href="../one_shot_object_detection/">
            
                    
                    One-Shot Object Detection
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.8" data-path="../style_transfer/">
            
                <a href="../style_transfer/">
            
                    
                    Style Transfer
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.3.8.1" data-path="../style_transfer/how-it-works.html">
            
                <a href="../style_transfer/how-it-works.html">
            
                    
                    How it works
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.8.2" data-path="../style_transfer/export-coreml.html">
            
                <a href="../style_transfer/export-coreml.html">
            
                    
                    Deployment to Core ML
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.3.9" data-path="../activity_classifier/">
            
                <a href="../activity_classifier/">
            
                    
                    Activity Classification
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.3.9.1" data-path="../activity_classifier/data-preparation.html">
            
                <a href="../activity_classifier/data-preparation.html">
            
                    
                    Data Preparation
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.9.2" data-path="../activity_classifier/advanced-usage.html">
            
                <a href="../activity_classifier/advanced-usage.html">
            
                    
                    Advanced Usage
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.9.3" data-path="../activity_classifier/export_coreml.html">
            
                <a href="../activity_classifier/export_coreml.html">
            
                    
                    Deployment to Core ML
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.9.4" data-path="../activity_classifier/how-it-works.html">
            
                <a href="../activity_classifier/how-it-works.html">
            
                    
                    How it works
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.3.10" data-path="../text_classifier/">
            
                <a href="../text_classifier/">
            
                    
                    Text Classifier
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.4" data-path="../modeling-data/">
            
                <a href="../modeling-data/">
            
                    
                    Machine learning essentials
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.4.1" data-path="../supervised-learning/classifier.html">
            
                <a href="../supervised-learning/classifier.html">
            
                    
                    Classification
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.4.1.1" data-path="../supervised-learning/boosted_trees_classifier.html">
            
                <a href="../supervised-learning/boosted_trees_classifier.html">
            
                    
                    Boosted Trees Classifier
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.1.2" data-path="../supervised-learning/decision_tree_classifier.html">
            
                <a href="../supervised-learning/decision_tree_classifier.html">
            
                    
                    Decision Tree Classifier
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.1.3" data-path="../supervised-learning/logistic-regression.html">
            
                <a href="../supervised-learning/logistic-regression.html">
            
                    
                    Logistic Regression
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.1.4" data-path="../supervised-learning/knn_classifier.html">
            
                <a href="../supervised-learning/knn_classifier.html">
            
                    
                    Nearest Neighbor Classifier
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.1.5" data-path="../supervised-learning/random_forest_classifier.html">
            
                <a href="../supervised-learning/random_forest_classifier.html">
            
                    
                    Random Forest Classifier
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.1.6" data-path="../supervised-learning/svm.html">
            
                <a href="../supervised-learning/svm.html">
            
                    
                    SVM
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.1.7" data-path="../supervised-learning/export-coreml.html">
            
                <a href="../supervised-learning/export-coreml.html">
            
                    
                    Deployment to Core ML
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.4.2" data-path="../clustering/">
            
                <a href="../clustering/">
            
                    
                    Clustering
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.4.2.1" data-path="../clustering/kmeans.html">
            
                <a href="../clustering/kmeans.html">
            
                    
                    KMeans
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.2.2" data-path="../clustering/dbscan.html">
            
                <a href="../clustering/dbscan.html">
            
                    
                    DBSCAN
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.4.3" data-path="../graph_analytics/">
            
                <a href="../graph_analytics/">
            
                    
                    Graph analytics
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.4" data-path="../nearest_neighbors/nearest_neighbors.html">
            
                <a href="../nearest_neighbors/nearest_neighbors.html">
            
                    
                    Nearest neighbors
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.5" data-path="../supervised-learning/regression.html">
            
                <a href="../supervised-learning/regression.html">
            
                    
                    Regression
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.4.5.1" data-path="../supervised-learning/boosted_trees_regression.html">
            
                <a href="../supervised-learning/boosted_trees_regression.html">
            
                    
                    Boosted Trees Regression
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.5.2" data-path="../supervised-learning/decision_tree_regression.html">
            
                <a href="../supervised-learning/decision_tree_regression.html">
            
                    
                    Decision Tree Regression
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.5.3" data-path="../supervised-learning/linear-regression.html">
            
                <a href="../supervised-learning/linear-regression.html">
            
                    
                    Linear Regression
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.5.4" data-path="../supervised-learning/random_forest_regression.html">
            
                <a href="../supervised-learning/random_forest_regression.html">
            
                    
                    Random Forest Regression
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.5.5" data-path="../supervised-learning/export-coreml.html">
            
                <a href="../supervised-learning/export-coreml.html">
            
                    
                    Deployment to Core ML
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.4.6" data-path="../text/">
            
                <a href="../text/">
            
                    
                    Text analysis
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.5" data-path="../evaluation/">
            
                <a href="../evaluation/">
            
                    
                    Evaluating models
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.5.1" data-path="../evaluation/regression.html">
            
                <a href="../evaluation/regression.html">
            
                    
                    Regression metrics
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.2" data-path="../evaluation/classification.html">
            
                <a href="../evaluation/classification.html">
            
                    
                    Classification metrics
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.6" data-path="../conclusion.html">
            
                <a href="../conclusion.html">
            
                    
                    Additional Resources
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.6.1" data-path="../cpp.html">
            
                <a href="../cpp.html">
            
                    
                    C++ API
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.2" data-path="../datasets.html">
            
                <a href="../datasets.html">
            
                    
                    Dataset Disclaimer
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

    

    <li class="divider"></li>

    <li>
        <a href="https://www.gitbook.com" target="blank" class="gitbook-link">
            Published with GitBook
        </a>
    </li>
</ul>


                </nav>
            
        
    </div>

    <div class="book-body">
        
            <div class="body-inner">
                
                    

<div class="book-header" role="navigation">
    

    <!-- Title -->
    <h1>
        <i class="fa fa-circle-o-notch fa-spin"></i>
        <a href=".." >Using models</a>
    </h1>
</div>




                    <div class="page-wrapper" tabindex="-1" role="main">
                        <div class="page-inner">
                            
<div id="book-search-results">
    <div class="search-noresults">
    
                                <section class="normal markdown-section">
                                
                                <h1 id="using-models"><a name="using-models" class="plugin-anchor" href="#using-models"><i class="fa fa-link" aria-hidden="true"></i></a>Using models</h1><p>All recommender objects in the
<a href="https://apple.github.io/turicreate/docs/api/turicreate.toolkits.recommender.html" target="_blank">turicreate.recommender</a>
module expose a common set of methods, such as
<a href="https://apple.github.io/turicreate/docs/api/generated/turicreate.recommender.factorization_recommender.FactorizationRecommender.recommend.html#turicreate.recommender.factorization_recommender.FactorizationRecommender.recommend" target="_blank">recommend</a>
and
<a href="https://apple.github.io/turicreate/docs/api/generated/turicreate.recommender.factorization_recommender.FactorizationRecommender.evaluate.html" target="_blank">evaluate</a>.</p><p>In this section we will cover</p><ul><li><a href="#making-recommendations">Making recommendations</a>
</li>
<li><a href="#finding-similar-items">Finding similar items</a>
</li>
<li><a href="#saving-and-loading-models">Saving and loading</a>
</li></ul>
<h4 id="making-recommendations"><a name="making-recommendations" class="plugin-anchor" href="#making-recommendations"><i class="fa fa-link" aria-hidden="true"></i></a>Making recommendations</h4><p>Once a model is created, you can now make recommendations of new items
for users.  To do so, call <code>model.recommend()</code> with an SArray of user
ids.  If <code>users</code> is set to None, then <code>model.recommend()</code> will make
recommendations for all the users seen during model creation, automatically
excluding the items that are observed for each user.  In other words, if
<code>data</code> contains a row &quot;Alice, The Great Gatsby&quot;, then
<code>model.recommend()</code> will not recommend &quot;The Great Gatsby&quot; for user
&quot;Alice&quot;.  It will return at most <code>k</code> new items for each user, sorted by
their rank.  It will return fewer than <code>k</code> items if there are not enough
items that the user has not already rated or seen.</p><p>The <code>score</code> column of the output contains the <em>unnormalized</em>
prediction scores for each user-item pair.  The semantic meanings of
these scores may differ between models.  For the linear regression
model, for instance, a higher average score for a user means that the
model thinks that this user is generally more enthusiastic than
others.</p><p>There are a number of ways to make recommendations: for known users or
new users, with new observation data or side information, and with
different ways to explicitly control item inclusion or exclusion.  Let&apos;s
walk through these options together.</p><h5 id="making-recommendations-for-all-users"><a name="making-recommendations-for-all-users" class="plugin-anchor" href="#making-recommendations-for-all-users"><i class="fa fa-link" aria-hidden="true"></i></a>Making recommendations for all users</h5><p>By default, calling <code>m.recommend()</code> without any arguments returns the
top 10 recommendations for all users seen during model creation.  It
automatically excludes items that were seen during model creation. Hence
all generated recommendations are for items that the user has not
already seen.</p><pre><code class="lang-python">data = turicreate.SFrame({<span class="hljs-string">&apos;user_id&apos;</span>: [<span class="hljs-string">&quot;Ann&quot;</span>, <span class="hljs-string">&quot;Ann&quot;</span>, <span class="hljs-string">&quot;Ann&quot;</span>, <span class="hljs-string">&quot;Brian&quot;</span>, <span class="hljs-string">&quot;Brian&quot;</span>, <span class="hljs-string">&quot;Brian&quot;</span>],
                          <span class="hljs-string">&apos;item_id&apos;</span>: [<span class="hljs-string">&quot;Item1&quot;</span>, <span class="hljs-string">&quot;Item2&quot;</span>, <span class="hljs-string">&quot;Item4&quot;</span>, <span class="hljs-string">&quot;Item2&quot;</span>, <span class="hljs-string">&quot;Item3&quot;</span>, <span class="hljs-string">&quot;Item5&quot;</span>],
                          <span class="hljs-string">&apos;rating&apos;</span>: [<span class="hljs-number">1</span>, <span class="hljs-number">3</span>, <span class="hljs-number">2</span>, <span class="hljs-number">5</span>, <span class="hljs-number">4</span>, <span class="hljs-number">2</span>]})
m = turicreate.factorization_recommender.create(data, target=<span class="hljs-string">&apos;rating&apos;</span>)

recommendations = m.recommend()</code></pre>
<h5 id="making-recommendations-for-specific-users"><a name="making-recommendations-for-specific-users" class="plugin-anchor" href="#making-recommendations-for-specific-users"><i class="fa fa-link" aria-hidden="true"></i></a>Making recommendations for specific users</h5><p>If you specify a <code>list</code> or <code>SArray</code> of users, <code>recommend()</code> returns
recommendations for only those user(s). The user names must correspond
to strings in the <code>user_id</code> column in the training data.</p><pre><code class="lang-python">recommendations = m.recommend(users=[<span class="hljs-string">&apos;Brian&apos;</span>])</code></pre>
<h5 id="making-recommendations-for-specific-users-and-items"><a name="making-recommendations-for-specific-users-and-items" class="plugin-anchor" href="#making-recommendations-for-specific-users-and-items"><i class="fa fa-link" aria-hidden="true"></i></a>Making recommendations for specific users and items</h5><p>In situations where you build a model for all of your users and items,
you may wish to limit the recommendations for particular users based on
known item attributes. For example, for US-based customers you may want
to limit recommendations to US-based products. The following code sample
restricts recommendations to a subset of users and items -- specifically
those users and items whose value in the &apos;country&apos; column is equal to
&quot;United States&quot;.</p><pre><code>country = &apos;United States&apos;
m.recommend(users=users[&apos;user_id&apos;][users[&apos;country&apos;]==country].unique(),
            items=items[&apos;item_id&apos;][items[&apos;country&apos;]==country])</code></pre>
<h5 id="making-recommendations-for-new-users"><a name="making-recommendations-for-new-users" class="plugin-anchor" href="#making-recommendations-for-new-users"><i class="fa fa-link" aria-hidden="true"></i></a>Making recommendations for new users</h5><p>This is known as the &quot;cold-start&quot; problem.  The <code>recommend()</code> function
works seamlessly with new users. If the model has never seen the user,
then it defaults to recommending popular items:</p><pre><code class="lang-python">m.recommend([<span class="hljs-string">&apos;Charlie&apos;</span>])</code></pre>
<p>Here &apos;Charlie&apos; is a new user that does not appear in the training data.
Also note that you don&apos;t need to explicitly write down <code>users=</code>; Python
automatically assumes that arguments are provided in order, so the first
unnamed argument to <code>recommend()</code> is taken to be the user list.</p><h5 id="incorporating-information-about-a-new-user"><a name="incorporating-information-about-a-new-user" class="plugin-anchor" href="#incorporating-information-about-a-new-user"><i class="fa fa-link" aria-hidden="true"></i></a>Incorporating information about a new user</h5><p>To improve recommendations for new users, it helps to have side
information or new observation data for the user.</p><h5 id="incorporating-new-side-information"><a name="incorporating-new-side-information" class="plugin-anchor" href="#incorporating-new-side-information"><i class="fa fa-link" aria-hidden="true"></i></a>Incorporating new side information</h5><p>To incorporate side information, you must have already created a
recommender model that knows how to incorporate side features.  This can
be done by passing in side information to <code>create()</code>.  For example:</p><pre><code class="lang-python">user_info = turicreate.SFrame({<span class="hljs-string">&apos;user_id&apos;</span>: [<span class="hljs-string">&apos;Ann&apos;</span>, <span class="hljs-string">&apos;Brian&apos;</span>],
                                <span class="hljs-string">&apos;age_category&apos;</span>: [<span class="hljs-string">&apos;2&apos;</span>, <span class="hljs-string">&apos;3&apos;</span>]})
m_side_info = turicreate.factorization_recommender.create(data, target=<span class="hljs-string">&apos;rating&apos;</span>,
                                                             user_data=user_info)</code></pre>
<p>Now, we can add side information for the new user at recommendation
time. The new side information must contain a column with the same name
as the column in the training data that&apos;s designated as the &apos;user_id&apos;.
(For more details, please see the API documentation for
<a href="https://apple.github.io/turicreate/docs/api/generated/turicreate.recommender.create.html#turicreate.recommender.create" target="_blank">turicreate.recommender.create</a>.)</p><pre><code class="lang-python">new_user_info = turicreate.SFrame({<span class="hljs-string">&apos;user_id&apos;</span> : [<span class="hljs-string">&apos;Charlie&apos;</span>],
                                 <span class="hljs-string">&apos;age_category&apos;</span> : [<span class="hljs-string">&apos;2&apos;</span>]})
recommendations = m_side_info.recommend([<span class="hljs-string">&apos;Charlie&apos;</span>],
                                        new_user_data = new_user_info)</code></pre>
<p>Given Charlie&apos;s age category, the model can incorporate what it knows about the importance of age categories for item recommendations.  Currently, the following models can take side information into account when making recommendations: <a href="https://apple.github.io/turicreate/docs/api/generated/turicreate.linear_regression.LinearRegression.html" target="_blank">LinearRegressionModel</a>, <a href="https://apple.github.io/turicreate/docs/api/generated/turicreate.recommender.factorization_recommender.FactorizationRecommender.html#turicreate.recommender.factorization_recommender.FactorizationRecommender" target="_blank">FactorizationRecommender</a>.  LinearRegressionModel is the simpler model, and FactorizationRecommender the more powerful.  For more details on how each model makes use of side information, please refer to the model definition sections in the individual models&apos; API documentation.</p><h5 id="incorporating-new-observation-data"><a name="incorporating-new-observation-data" class="plugin-anchor" href="#incorporating-new-observation-data"><i class="fa fa-link" aria-hidden="true"></i></a>Incorporating new observation data</h5><p><code>recommend()</code> accepts new observation data. Currently, the <a href="https://apple.github.io/turicreate/docs/api/generated/turicreate.recommender.item_similarity_recommender.ItemSimilarityRecommender.html" target="_blank">ItemSimilarityModel</a> makes the best use of this information.</p><pre><code class="lang-python">m_item_sim = turicreate.item_similarity_recommender.create(data)
new_obs_data = turicreate.SFrame({<span class="hljs-string">&apos;user_id&apos;</span> : [<span class="hljs-string">&apos;Charlie&apos;</span>, <span class="hljs-string">&apos;Charlie&apos;</span>],
                                <span class="hljs-string">&apos;item_id&apos;</span> : [<span class="hljs-string">&apos;Item1&apos;</span>, <span class="hljs-string">&apos;Item5&apos;</span>]})
recommendations = m_item_sim.recommend([<span class="hljs-string">&apos;Charlie&apos;</span>], new_observation_data = new_obs_data)</code></pre>
<h5 id="controlling-the-number-of-recommendations"><a name="controlling-the-number-of-recommendations" class="plugin-anchor" href="#controlling-the-number-of-recommendations"><i class="fa fa-link" aria-hidden="true"></i></a>Controlling the number of recommendations</h5><p>The input parameter <code>k</code> controls how many items to recommend for each user.</p><pre><code class="lang-python">recommendations = m.recommend(k = <span class="hljs-number">5</span>)</code></pre>
<h5 id="excluding-specific-items-from-recommendation"><a name="excluding-specific-items-from-recommendation" class="plugin-anchor" href="#excluding-specific-items-from-recommendation"><i class="fa fa-link" aria-hidden="true"></i></a>Excluding specific items from recommendation</h5><p>Suppose you make some recommendations to the user and they ignored them.
So now you want other recommendations.  This can be done by explicitly
excluding those undesirable items via the <code>exclude</code> keyword argument.</p><pre><code class="lang-python">exclude_pairs = turicreate.SFrame({<span class="hljs-string">&apos;user_id&apos;</span> : [<span class="hljs-string">&apos;Ann&apos;</span>],
                                    <span class="hljs-string">&apos;item_id&apos;</span> : [<span class="hljs-string">&apos;Item3&apos;</span>]})

recommendations = m.recommend([<span class="hljs-string">&apos;Ann&apos;</span>], k = <span class="hljs-number">5</span>, exclude = exclude_pairs)</code></pre>
<p>By default, <code>recommend()</code> excludes items seen during training, so that
it would not recommend items that the user has already seen.  To change
this behavior, you can specify <code>exclude_known=False</code>.</p><pre><code class="lang-python">recommendations = m.recommend(exclude_known = <span class="hljs-keyword">False</span>)</code></pre>
<h5 id="including-specific-items-in-recommendation"><a name="including-specific-items-in-recommendation" class="plugin-anchor" href="#including-specific-items-in-recommendation"><i class="fa fa-link" aria-hidden="true"></i></a>Including specific items in recommendation</h5><p>Suppose you want to see only recommendations within a subset of items.
This can be done via the <code>items</code> keyword argument.  The input must be an
SArray of items.</p><pre><code class="lang-python">item_subset = turicreate.SArray([<span class="hljs-string">&quot;Item3&quot;</span>, <span class="hljs-string">&quot;Item5&quot;</span>, <span class="hljs-string">&quot;Item2&quot;</span>])
recommendations = m.recommend([<span class="hljs-string">&apos;Ann&apos;</span>], items = item_subset)</code></pre>
<h4 id="finding-similar-items"><a name="finding-similar-items" class="plugin-anchor" href="#finding-similar-items"><i class="fa fa-link" aria-hidden="true"></i></a>Finding Similar Items</h4><p>Many of the above models make recommendations based on some notion of
similarity between a pair of items. Querying for similar items can help
you understand the model&apos;s behavior on your data.</p><p>We have made this process very easy with the
<a href="https://apple.github.io/turicreate/docs/api/generated/turicreate.recommender.item_similarity_recommender.ItemSimilarityRecommender.get_similar_items.html#turicreate.recommender.item_similarity_recommender.ItemSimilarityRecommender.get_similar_items" target="_blank">get_similar_items</a>
function:</p><pre><code class="lang-python">similar_items = model.get_similar_items(my_list_of_items, k=<span class="hljs-number">20</span>)</code></pre>
<p>The above will return an SFrame containing the 20 nearest items for
every item in <code>my_list_of_items</code>. The definition of &quot;nearest&quot; depends on
the type of similarity used by the model. For instance, &quot;jaccard&quot;
similarity measures the two item&apos;s overlapping users. The &apos;score&apos; column
contains a similarity score ranging between 0 and 1, where larger values
indicate increasing similarity. The mathematical formula used for each
type of similarity can be found in the API documentation for
<a href="https://apple.github.io/turicreate/docs/api/generated/turicreate.recommender.item_similarity_recommender.ItemSimilarityRecommender.html#turicreate.recommender.item_similarity_recommender.ItemSimilarityRecommender" target="_blank">ItemSimilarityRecommender</a>.</p><p>For a factorization-based model, the similarity used for is the
Euclidean distance between the items&apos; two factors, which can be obtained
using m[&apos;coefficients&apos;].</p><h4 id="saving-and-loading-models"><a name="saving-and-loading-models" class="plugin-anchor" href="#saving-and-loading-models"><i class="fa fa-link" aria-hidden="true"></i></a>Saving and loading models</h4><p>The model can be saved for later use, either on the local machine or in
an AWS S3 bucket. The saved model sits in its own directory, and can be
loaded back in later to make more predictions.</p><pre><code class="lang-python">model.save(<span class="hljs-string">&quot;recommendations.model&quot;</span>)</code></pre>
<p>Like other models in Turi Create, we can load the model back:</p><pre><code class="lang-python">model = tc.load_model(<span class="hljs-string">&quot;recommendations.model&quot;</span>)</code></pre>

                                
                                </section>
                            
    </div>
    <div class="search-results">
        <div class="has-results">
            
            <h1 class="search-results-title"><span class='search-results-count'></span> results matching "<span class='search-query'></span>"</h1>
            <ul class="search-results-list"></ul>
            
        </div>
        <div class="no-results">
            
            <h1 class="search-results-title">No results matching "<span class='search-query'></span>"</h1>
            
        </div>
    </div>
</div>

                        </div>
                    </div>
                
            </div>

            
                
                <a href="./" class="navigation navigation-prev " aria-label="Previous page: Recommender Systems">
                    <i class="fa fa-angle-left"></i>
                </a>
                
                
                <a href="choosing-a-model.html" class="navigation navigation-next " aria-label="Next page: Choosing a model">
                    <i class="fa fa-angle-right"></i>
                </a>
                
            
        
    </div>

    <script>
        var gitbook = gitbook || [];
        gitbook.push(function() {
            gitbook.page.hasChanged({"page":{"title":"Using models","level":"1.3.1.1","depth":3,"next":{"title":"Choosing a model","level":"1.3.1.2","depth":3,"path":"recommender/choosing-a-model.md","ref":"recommender/choosing-a-model.md","articles":[]},"previous":{"title":"Recommender Systems","level":"1.3.1","depth":2,"path":"recommender/README.md","ref":"recommender/README.md","articles":[{"title":"Using models","level":"1.3.1.1","depth":3,"path":"recommender/using-trained-models.md","ref":"recommender/using-trained-models.md","articles":[]},{"title":"Choosing a model","level":"1.3.1.2","depth":3,"path":"recommender/choosing-a-model.md","ref":"recommender/choosing-a-model.md","articles":[]},{"title":"Deployment to Core ML","level":"1.3.1.3","depth":3,"path":"recommender/coreml-deployment.md","ref":"recommender/coreml-deployment.md","articles":[]}]},"dir":"ltr"},"config":{"gitbook":"3.2.0","theme":"default","variables":{},"plugins":["collapsible-menu@1.0.2","anchors@0.5.0","mathjax"],"pluginsConfig":{"collapsible-menu":{},"search":{},"lunr":{"maxIndexSize":1000000,"ignoreSpecialCharacters":false},"fontsettings":{"theme":"white","family":"sans","size":2},"fontSettings":{"theme":"white","family":"sans","size":2},"highlight":{},"mathjax":{"forceSVG":false,"version":"2.6-latest"},"sharing":{"facebook":true,"twitter":true,"google":false,"weibo":false,"instapaper":false,"vk":false,"all":["facebook","google","twitter","weibo","instapaper"]},"theme-default":{"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"},"showLevel":false},"anchors":{}},"structure":{"langs":"LANGS.md","readme":"README.md","glossary":"GLOSSARY.md","summary":"SUMMARY.md"},"pdf":{"pageNumbers":true,"fontSize":12,"fontFamily":"Arial","paperSize":"a4","chapterMark":"pagebreak","pageBreaksBefore":"/","margin":{"right":62,"left":62,"top":56,"bottom":56}},"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"}},"file":{"path":"recommender/using-trained-models.md","mtime":"2019-12-18T08:20:40.343Z","type":"markdown"},"gitbook":{"version":"3.2.0","time":"2019-12-18T08:23:36.544Z"},"basePath":"..","book":{"language":""}});
        });
    </script>
</div>

        
    <script src="../gitbook/gitbook.js"></script>
    <script src="../gitbook/theme.js"></script>
    
        
        <script src="../gitbook/gitbook-plugin-collapsible-menu/plugin.js"></script>
        
    
        
        <script src="https://cdn.mathjax.org/mathjax/2.6-latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-mathjax/plugin.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-search/search-engine.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-search/search.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-lunr/lunr.min.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-lunr/search-lunr.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-sharing/buttons.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-fontsettings/fontsettings.js"></script>
        
    

    </body>
</html>

