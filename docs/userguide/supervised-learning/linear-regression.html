
<!DOCTYPE HTML>
<html lang="" >
    <head>
        <title>Linear Regression Â· GitBook</title>
        <meta charset="UTF-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta name="description" content="">
        <meta name="generator" content="GitBook 3.2.0">
        
        
        
    
    <link rel="stylesheet" href="../gitbook/style.css">

    
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-anchors/plugin.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-highlight/website.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-search/search.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-fontsettings/website.css">
                
            
        

    

    
        
    
        
    
        
    
        
    
        
    
        
    

        
    
    
    
    <meta name="HandheldFriendly" content="true"/>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <link rel="apple-touch-icon-precomposed" sizes="152x152" href="../gitbook/images/apple-touch-icon-precomposed-152.png">
    <link rel="shortcut icon" href="../gitbook/images/favicon.ico" type="image/x-icon">

    
    <link rel="next" href="random_forest_regression.html" />
    
    
    <link rel="prev" href="decision_tree_regression.html" />
    

    <script src="../turi/js/jquery/jquery-2.1.3.min.js"></script>
    <script src="../turi/js/d3/d3.min.js"></script>
    <script src="images/random-utils.js"></script>
    <script src="images/plotting-utils.js"></script>

    </head>
    <body>
        
<div class="book">
    <div class="book-summary">
        
            
<div id="book-search-input" role="search">
    <input type="text" placeholder="Type to search" />
</div>

            
                <nav role="navigation">
                


<ul class="summary">
    
    

    

    
        
        
    
        <li class="chapter " data-level="1.1" data-path="../">
            
                <a href="../">
            
                    
                    Overview
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2" data-path="../sframe/">
            
                <a href="../sframe/">
            
                    
                    Working with data
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.2.1" data-path="../sframe/tabular-data.html">
            
                <a href="../sframe/tabular-data.html">
            
                    
                    Tabular data
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.2.1.1" data-path="../sframe/sframe-intro.html">
            
                <a href="../sframe/sframe-intro.html">
            
                    
                    Loading and Saving
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.1.2" data-path="../sframe/data-manipulation.html">
            
                <a href="../sframe/data-manipulation.html">
            
                    
                    Data Manipulation
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.1.3" data-path="../data_formats_and_sources/sql_integration.html">
            
                <a href="../data_formats_and_sources/sql_integration.html">
            
                    
                    SQL Databases
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.2.2" data-path="../sgraph/sgraph.html">
            
                <a href="../sgraph/sgraph.html">
            
                    
                    Graph data
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.3" data-path="../text/analysis.html">
            
                <a href="../text/analysis.html">
            
                    
                    Text data
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.4" data-path="../vis/">
            
                <a href="../vis/">
            
                    
                    Visualization
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.2.4.1" data-path="../vis/gallery.html">
            
                <a href="../vis/gallery.html">
            
                    
                    Example Gallery
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.4.2" data-path="../vis/use_cases.html">
            
                <a href="../vis/use_cases.html">
            
                    
                    Sample Use Cases
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.3" data-path="../applications/">
            
                <a href="../applications/">
            
                    
                    Task focused toolkits
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.3.1" data-path="../recommender/">
            
                <a href="../recommender/">
            
                    
                    Recommender Systems
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.3.1.1" data-path="../recommender/using-trained-models.html">
            
                <a href="../recommender/using-trained-models.html">
            
                    
                    Using models
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.1.2" data-path="../recommender/choosing-a-model.html">
            
                <a href="../recommender/choosing-a-model.html">
            
                    
                    Choosing a model
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.1.3" data-path="../recommender/coreml-deployment.html">
            
                <a href="../recommender/coreml-deployment.html">
            
                    
                    Deployment to Core ML
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.3.2" data-path="../image_classifier/">
            
                <a href="../image_classifier/">
            
                    
                    Image Classification
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.3.2.1" data-path="../image_classifier/advanced-usage.html">
            
                <a href="../image_classifier/advanced-usage.html">
            
                    
                    Advanced Usage
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.2.2" data-path="../image_classifier/how-it-works.html">
            
                <a href="../image_classifier/how-it-works.html">
            
                    
                    How it works
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.2.3" data-path="../image_classifier/export-coreml.html">
            
                <a href="../image_classifier/export-coreml.html">
            
                    
                    Deployment to Core ML
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.3.3" data-path="../drawing_classifier/">
            
                <a href="../drawing_classifier/">
            
                    
                    Drawing Classification
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.3.3.1" data-path="../drawing_classifier/how-it-works.html">
            
                <a href="../drawing_classifier/how-it-works.html">
            
                    
                    How it works
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.3.2" data-path="../drawing_classifier/data-preparation.html">
            
                <a href="../drawing_classifier/data-preparation.html">
            
                    
                    Data Preparation
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.3.3" data-path="../drawing_classifier/export-coreml.html">
            
                <a href="../drawing_classifier/export-coreml.html">
            
                    
                    Deployment to Core ML
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.3.4" data-path="../drawing_classifier/advanced-usage.html">
            
                <a href="../drawing_classifier/advanced-usage.html">
            
                    
                    Advanced Usage
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.3.4" data-path="../sound_classifier/">
            
                <a href="../sound_classifier/">
            
                    
                    Sound Classification
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.3.4.1" data-path="../sound_classifier/how-it-works.html">
            
                <a href="../sound_classifier/how-it-works.html">
            
                    
                    How it works
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.4.2" data-path="../sound_classifier/advanced-usage.html">
            
                <a href="../sound_classifier/advanced-usage.html">
            
                    
                    Advanced Usage
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.4.3" data-path="../sound_classifier/export-coreml.html">
            
                <a href="../sound_classifier/export-coreml.html">
            
                    
                    Deployment to Core ML
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.3.5" data-path="../image_similarity/">
            
                <a href="../image_similarity/">
            
                    
                    Image Similarity
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.3.5.1" data-path="../image_similarity/export-coreml.html">
            
                <a href="../image_similarity/export-coreml.html">
            
                    
                    Deployment to Core ML
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.3.6" data-path="../object_detection/">
            
                <a href="../object_detection/">
            
                    
                    Object Detection
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.3.6.1" data-path="../object_detection/data-preparation.html">
            
                <a href="../object_detection/data-preparation.html">
            
                    
                    Data Preparation
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.6.2" data-path="../object_detection/advanced-usage.html">
            
                <a href="../object_detection/advanced-usage.html">
            
                    
                    Advanced Usage
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.6.3" data-path="../object_detection/export-coreml.html">
            
                <a href="../object_detection/export-coreml.html">
            
                    
                    Deployment to Core ML
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.6.4" data-path="../object_detection/how-it-works.html">
            
                <a href="../object_detection/how-it-works.html">
            
                    
                    How it works
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.3.7" data-path="../one_shot_object_detection/">
            
                <a href="../one_shot_object_detection/">
            
                    
                    One-Shot Object Detection
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.8" data-path="../style_transfer/">
            
                <a href="../style_transfer/">
            
                    
                    Style Transfer
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.3.8.1" data-path="../style_transfer/how-it-works.html">
            
                <a href="../style_transfer/how-it-works.html">
            
                    
                    How it works
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.8.2" data-path="../style_transfer/export-coreml.html">
            
                <a href="../style_transfer/export-coreml.html">
            
                    
                    Deployment to Core ML
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.3.9" data-path="../activity_classifier/">
            
                <a href="../activity_classifier/">
            
                    
                    Activity Classification
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.3.9.1" data-path="../activity_classifier/data-preparation.html">
            
                <a href="../activity_classifier/data-preparation.html">
            
                    
                    Data Preparation
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.9.2" data-path="../activity_classifier/advanced-usage.html">
            
                <a href="../activity_classifier/advanced-usage.html">
            
                    
                    Advanced Usage
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.9.3" data-path="../activity_classifier/export_coreml.html">
            
                <a href="../activity_classifier/export_coreml.html">
            
                    
                    Deployment to Core ML
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.9.4" data-path="../activity_classifier/how-it-works.html">
            
                <a href="../activity_classifier/how-it-works.html">
            
                    
                    How it works
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.3.10" data-path="../text_classifier/">
            
                <a href="../text_classifier/">
            
                    
                    Text Classifier
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.4" data-path="../modeling-data/">
            
                <a href="../modeling-data/">
            
                    
                    Machine learning essentials
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.4.1" data-path="classifier.html">
            
                <a href="classifier.html">
            
                    
                    Classification
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.4.1.1" data-path="boosted_trees_classifier.html">
            
                <a href="boosted_trees_classifier.html">
            
                    
                    Boosted Trees Classifier
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.1.2" data-path="decision_tree_classifier.html">
            
                <a href="decision_tree_classifier.html">
            
                    
                    Decision Tree Classifier
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.1.3" data-path="logistic-regression.html">
            
                <a href="logistic-regression.html">
            
                    
                    Logistic Regression
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.1.4" data-path="knn_classifier.html">
            
                <a href="knn_classifier.html">
            
                    
                    Nearest Neighbor Classifier
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.1.5" data-path="random_forest_classifier.html">
            
                <a href="random_forest_classifier.html">
            
                    
                    Random Forest Classifier
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.1.6" data-path="svm.html">
            
                <a href="svm.html">
            
                    
                    SVM
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.1.7" data-path="export-coreml.html">
            
                <a href="export-coreml.html">
            
                    
                    Deployment to Core ML
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.4.2" data-path="../clustering/">
            
                <a href="../clustering/">
            
                    
                    Clustering
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.4.2.1" data-path="../clustering/kmeans.html">
            
                <a href="../clustering/kmeans.html">
            
                    
                    KMeans
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.2.2" data-path="../clustering/dbscan.html">
            
                <a href="../clustering/dbscan.html">
            
                    
                    DBSCAN
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.4.3" data-path="../graph_analytics/">
            
                <a href="../graph_analytics/">
            
                    
                    Graph analytics
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.4" data-path="../nearest_neighbors/nearest_neighbors.html">
            
                <a href="../nearest_neighbors/nearest_neighbors.html">
            
                    
                    Nearest neighbors
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.5" data-path="regression.html">
            
                <a href="regression.html">
            
                    
                    Regression
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.4.5.1" data-path="boosted_trees_regression.html">
            
                <a href="boosted_trees_regression.html">
            
                    
                    Boosted Trees Regression
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.5.2" data-path="decision_tree_regression.html">
            
                <a href="decision_tree_regression.html">
            
                    
                    Decision Tree Regression
            
                </a>
            

            
        </li>
    
        <li class="chapter active" data-level="1.4.5.3" data-path="linear-regression.html">
            
                <a href="linear-regression.html">
            
                    
                    Linear Regression
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.5.4" data-path="random_forest_regression.html">
            
                <a href="random_forest_regression.html">
            
                    
                    Random Forest Regression
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.5.5" data-path="export-coreml.html">
            
                <a href="export-coreml.html">
            
                    
                    Deployment to Core ML
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.4.6" data-path="../text/">
            
                <a href="../text/">
            
                    
                    Text analysis
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.5" data-path="../evaluation/">
            
                <a href="../evaluation/">
            
                    
                    Evaluating models
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.5.1" data-path="../evaluation/regression.html">
            
                <a href="../evaluation/regression.html">
            
                    
                    Regression metrics
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.2" data-path="../evaluation/classification.html">
            
                <a href="../evaluation/classification.html">
            
                    
                    Classification metrics
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.6" data-path="../conclusion.html">
            
                <a href="../conclusion.html">
            
                    
                    Additional Resources
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.6.1" data-path="../cpp.html">
            
                <a href="../cpp.html">
            
                    
                    C++ API
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.2" data-path="../datasets.html">
            
                <a href="../datasets.html">
            
                    
                    Dataset Disclaimer
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

    

    <li class="divider"></li>

    <li>
        <a href="https://www.gitbook.com" target="blank" class="gitbook-link">
            Published with GitBook
        </a>
    </li>
</ul>


                </nav>
            
        
    </div>

    <div class="book-body">
        
            <div class="body-inner">
                
                    

<div class="book-header" role="navigation">
    

    <!-- Title -->
    <h1>
        <i class="fa fa-circle-o-notch fa-spin"></i>
        <a href=".." >Linear Regression</a>
    </h1>
</div>




                    <div class="page-wrapper" tabindex="-1" role="main">
                        <div class="page-inner">
                            
<div id="book-search-results">
    <div class="search-noresults">
    
                                <section class="normal markdown-section">
                                
                                <h1 id="linear-regression"><a name="linear-regression" class="plugin-anchor" href="#linear-regression"><i class="fa fa-link" aria-hidden="true"></i></a>Linear Regression</h1><p>Turi Create&apos;s <a href="https://apple.github.io/turicreate/docs/api/generated/turicreate.linear_regression.LinearRegression.html" target="_blank">linear
regression</a>
module is used to predict a continuous <strong>target</strong> as a linear function
of <strong>features</strong>. This is a two-stage process, analogous to many other
Turi toolkits. First a model is created using <strong>training data</strong>. Once
the model is created, it can then be used to make predictions on new
examples that were not seen in training (the  <strong>test data</strong>). Model
creation, prediction, and evaluation work will data that is contained in
an SFrame. The following figure illustrates how linear regression works.
Notice that the functional form learned here is a linear function
(unlike the previous figure where the predicted function was
non-linear).</p><div id="linregr-plot"></div>



<script src="images/linregr-plot.js"></script>



<h5 id="background"><a name="background" class="plugin-anchor" href="#background"><i class="fa fa-link" aria-hidden="true"></i></a>Background</h5><p>Given a set of features <script type="math/tex; ">x_i</script>, and a label <script type="math/tex; ">y_i</script> (where <script type="math/tex; ">i</script>
denotes a single example in the training data), linear regression
assumes that the target <script type="math/tex; ">y_i</script> is a linear combination of the features</p><p><script type="math/tex; ">x_i</script> i.e<script type="math/tex; mode=display">

```
y_i = f_i(\theta) =  \theta^T x + \epsilon_i
```


</script>
where <script type="math/tex; ">\epsilon_i</script> is random Gaussian noise with mean <script type="math/tex; ">0</script> and
variance <script type="math/tex; ">\sigma</script>.  <strong>An intercept term</strong> is added by appending a
column of 1&apos;s to the features.  Regularization is often required to
prevent over-fitting by penalizing models with extreme parameter values.
The linear regression module supports L1 and L2
<a href="http://en.wikipedia.org/wiki/Regularization_%28mathematics%29" target="_blank">regularization</a>,
which are added to the loss function.</p><p>The composite objective being optimized for is the following:
<script type="math/tex; mode=display">


```
\min_{\theta} \sum_{i = 1}^{n} (\theta^Tx - y_i)^2 + \lambda_1 \|\theta\|_1 + \lambda_2 \|\theta\|_2^2
```


</script>
where <script type="math/tex; ">\lambda_1</script> is the <code>l1_penalty</code> and <script type="math/tex; ">\lambda_2</script> is the <code>l2_penalty</code>.</p><h5 id="introductory-example"><a name="introductory-example" class="plugin-anchor" href="#introductory-example"><i class="fa fa-link" aria-hidden="true"></i></a>Introductory Example</h5><p>Suppose we have a dataset containing restaurant reviews. The
task is to <strong>predict the &apos;star rating&apos; for a restaurant for a given
user</strong>.</p><p>We will first split the data into a train-test split and then create a linear
regression model that can predict the <strong>star rating</strong> for each review using:</p><ul><li>Average rating of a given business
</li>
<li>Average rating made by a user
</li>
<li>Number of reviews made by a user
</li>
<li>Number of reviews that concern a business
</li></ul>
<pre><code class="lang-python"><span class="hljs-keyword">import</span> turicreate <span class="hljs-keyword">as</span> tc

<span class="hljs-comment"># Load the data</span>
data =  tc.SFrame(<span class="hljs-string">&apos;ratings-data.csv&apos;</span>)

<span class="hljs-comment"># Make a train-test split</span>
train_data, test_data = data.random_split(<span class="hljs-number">0.8</span>)

<span class="hljs-comment"># Create a model.</span>
model = tc.linear_regression.create(train_data, target=<span class="hljs-string">&apos;stars&apos;</span>,
                                    features = [<span class="hljs-string">&apos;user_avg_stars&apos;</span>,
                                                <span class="hljs-string">&apos;business_avg_stars&apos;</span>,
                                                <span class="hljs-string">&apos;user_review_count&apos;</span>,
                                                <span class="hljs-string">&apos;business_review_count&apos;</span>])

<span class="hljs-comment"># Save predictions to an SFrame (class and corresponding class-probabilities)</span>
predictions = model.predict(test_data)

<span class="hljs-comment"># Evaluate the model and save the results into a dictionary</span>
results = model.evaluate(test_data)</code></pre>
<h5 id="additional-features"><a name="additional-features" class="plugin-anchor" href="#additional-features"><i class="fa fa-link" aria-hidden="true"></i></a>Additional Features</h5><p>We will now go over some more advanced options with the linear regression
module. This includes regularization, evaluation options, model interpretation,
and missing value handling.  Note that <strong>logistic regression and support vector
machines (SVM)</strong> conform to <strong>almost</strong> all of the API discussed below.</p><h6 id="accessing-attributes-of-the-model"><a name="accessing-attributes-of-the-model" class="plugin-anchor" href="#accessing-attributes-of-the-model"><i class="fa fa-link" aria-hidden="true"></i></a><a name="accessing-attributes-of-the-model"></a>Accessing attributes of the model</h6><p>The attributes of all Turi Create models, which include training statistics, model
hyper-parameters, and model results can be accessed in the same way as python
dictionaries.</p><h6 id="interpreting-results"><a name="interpreting-results" class="plugin-anchor" href="#interpreting-results"><i class="fa fa-link" aria-hidden="true"></i></a><a name="interpreting-results"></a>Interpreting results</h6><p>Linear regression can provide valuable insight about the relationships between
the target and feature columns in your data, revealing why your model returns
the predictions that it does. The <strong>coefficients</strong> (<script type="math/tex; ">\theta</script>) are what the
training procedure learns. Each model coefficient describes the expected change
in the target variable associated with a unit change in the feature. The bias
term indicates the &quot;inherent&quot; or &quot;average&quot; target value if all feature values
were set to zero.</p><p>The coefficients often tell an interesting story of how much each feature
matters in predicting target values. The magnitude (absolute value) of the
coefficient for each feature indicates the strength of the feature&apos;s association
to the target variable, <strong>holding all other features constant</strong>. The sign on the
coefficient (positive or negative) gives the direction of the association.</p><p>When a Turi Create regression model is trained, the <code>model.summary()</code> output
shows the largest positive and negative coefficients. After a model is
created, we can access the coefficients as follows:</p><pre><code class="lang-python">coefs = model.coefficients
print(coefs)</code></pre>
<pre><code class="lang-no-highlight">+-----------------------+-------+-------------------+-------------------+
|          name         | index |       value       |       stderr      |
+-----------------------+-------+-------------------+-------------------+
|      (intercept)      |  None |   -2.22993154648  |  0.0199750718984  |
|     user_avg_stars    |  None |   0.809669227421  |  0.00414406824672 |
|   business_avg_stars  |  None |   0.781099022798  |  0.00419064940637 |
|   user_review_count   |  None | 1.85023282568e-05 | 1.15481783547e-05 |
| business_review_count |  None | 7.06842770902e-05 | 1.72332966093e-05 |
+-----------------------+-------+-------------------+-------------------+
[5 rows x 3 columns]</code></pre>
<p>Note that the <strong>index</strong> column in the coefficients is only applicable for
categorical features, lists, and dictionaries. In the SFrame above, there is an
extra column for <code>standard errors</code> on the estimated coefficients (see section
below for a more detailed explanation).</p><h6 id="standard-errors"><a name="standard-errors" class="plugin-anchor" href="#standard-errors"><i class="fa fa-link" aria-hidden="true"></i></a><a name="standard-errors"></a> Standard-errors</h6><p>The standard error is the empirical standard deviation on the estimated
coefficient. For example, a coefficient of 1 with a standard error of 0.5
implies a standard deviation of 0.5 on the estimated values of the
coefficients. Standard errors capture the <code>confidence</code> we have in the
coefficients estimated during model creation. Smaller standard errors implies
more confidence in the value of the coefficients returned by th model.</p><p>Standard errors on coefficients are only available when <code>solver=newton</code> or
when the default <code>auto</code> solver option chooses the newton method and if the
number of examples in the training data is more than the number of
coefficients. If standard errors cannot be estimated, a column of <code>None</code> values
are returned.</p><h6 id="categorical-features"><a name="categorical-features" class="plugin-anchor" href="#categorical-features"><i class="fa fa-link" aria-hidden="true"></i></a><a name="categorical-features"></a>Categorical features</h6><p>Categorical variables are features that can take one of a limited, and usually
fixed, number of possible values. Each category is referred to as a level. As an
example, consider the variable <strong>city</strong> that a given restaurant is in. This
dataset has about 60 unique strings for the <strong>city</strong> (the number of unique
values in the output of Turi Canvas is approximate).</p><pre><code>city = train_data[&apos;city&apos;]
city.show()</code></pre>
<p><img alt="city.show()" src="images/supervised-learning-city-categorical.png"></p><p>The regression module in Turi Create uses <strong>simple encoding</strong> while
creating models using string features. Simple encoding compares each category
to an arbitrary reference category (we choose the first category of the data as
the reference).  In other words, we add <em>dummy coefficients</em> to encode each
category.  The number of these dummy coefficients is equal to the total number
of categories minus 1 (for the reference category). The following figure
illustrates how categorical variables are encoded using the <strong>simple encoding</strong>
scheme.</p><p><a href="images/supervised-learning-categorical-variable-encoding.png"><img alt="Categorical variable summary" src="images/supervised-learning-categorical-variable-encoding.png" style="max-width: 70%; margin-left: 15%;"></a></p><p>Now let us look at a simple example of using <strong>city</strong> as a variable in the
linear regression model. Notice that there is no need to do any special
pre-processing. All SFrame columns of type <strong>str</strong> are automatically
transformed into categorical variables. Notice that the <strong>number of
coefficients</strong> and the <strong>number of features</strong> aren&apos;t the same.</p><p>In this example, there are 60 unique cities, so 59 dummy
coefficients. Turi Create can handle categorical variables with
<strong>millions</strong> of categories.</p><pre><code class="lang-python"><span class="hljs-comment"># Create a model with categorical features.</span>
model = tc.linear_regression.create(train_data, target=<span class="hljs-string">&apos;stars&apos;</span>,
                                    features = [<span class="hljs-string">&apos;user_avg_stars&apos;</span>,
                                                <span class="hljs-string">&apos;business_avg_stars&apos;</span>,
                                                <span class="hljs-string">&apos;user_review_count&apos;</span>,
                                                <span class="hljs-string">&apos;business_review_count&apos;</span>,
                                                <span class="hljs-string">&apos;city&apos;</span>])

<span class="hljs-comment"># Number of feature columns</span>
print(<span class="hljs-string">&quot;Number of features          : %s&quot;</span> % model[<span class="hljs-string">&apos;num_features&apos;</span>])

<span class="hljs-comment"># Number of features (including expanded lists and dictionaries)</span>
print(<span class="hljs-string">&quot;Number of unpacked features : %s&quot;</span> % model[<span class="hljs-string">&apos;num_unpacked_features&apos;</span>])

<span class="hljs-comment"># Number of coefficients in the model</span>
print(<span class="hljs-string">&quot;Number of coefficients      : %s&quot;</span> % model[<span class="hljs-string">&apos;num_coefficients&apos;</span>])

<span class="hljs-comment"># A coefficient is included for each category</span>
print(model[<span class="hljs-string">&apos;coefficients&apos;</span>])</code></pre>
<pre><code class="lang-no-highlight">Number of features          : 5
Number of unpacked features : 5
Number of coefficients      : 64

+-----------------------+------------+-------------------+
|          name         |   index    |       value       |
+-----------------------+------------+-------------------+
|      (intercept)      |    None    |   -2.23521785747  |
|     user_avg_stars    |    None    |   0.812827992012  |
|   business_avg_stars  |    None    |   0.778447236096  |
|   user_review_count   |    None    | 2.48618619187e-05 |
| business_review_count |    None    | 0.000102740183746 |
|          city         |   Tempe    |  -0.0214425060978 |
|          city         | Scottsdale | -0.00858553630484 |
|          city         |    Mesa    |  0.0109508448699  |
|          city         |  Chandler  |  0.0390579171569  |
|          city         |  Gilbert   | -0.00525039510189 |
|          ...          |    ...     |        ...        |
+-----------------------+------------+-------------------+
[64 rows x 3 columns]

Note: Only the head of the SFrame is printed.
You can use print_rows(num_rows=m, num_columns=n) to print more rows and columns.
</code></pre>
<h6 id="sparse-features"><a name="sparse-features" class="plugin-anchor" href="#sparse-features"><i class="fa fa-link" aria-hidden="true"></i></a><a name="sparse-features"></a> Sparse features</h6><p>Sparsity is one of the most important things to consider when working with
a lot of data. Sparse features are encoded using a dictionary where the keys
represent the feature names and the values are the feature values.
A coefficient is added for each key in the union of the set of keys for all
dictionaries across all examples. For a particular example, only non-zero
values need to be stored in the dictionary.  The following illustration
describes how Turi Create dictionary features leverage sparsity in your
data.</p><p><a href="images/supervised-learning-dictionary-variables.png"><img alt="Dictionary variable summary" src="images/supervised-learning-dictionary-variables.png" style="max-width: 70%; margin-left: 15%;"></a></p><p>Often, the sparse representation using dictionaries is much more efficient than
using the dense representation.</p><p>Reviews contain useful tags that describe each business. Unlike
categorical variables, a business may have several tags. These tags are stored
using dictionaries.  <strong>Not all tags</strong> are associated with every restaurant, so
we will only store those tags that are associated with restaurant and assume
that all tags <strong>not explicitly provided are treated as features with value
zero</strong>. We illustrate with the following example:</p><pre><code class="lang-python">print(train_data[<span class="hljs-string">&apos;categories_dict&apos;</span>].head(<span class="hljs-number">3</span>))</code></pre>
<pre><code class="lang-no-highlight">[{&apos;Breakfast &amp; Brunch&apos;: 1, &apos;Restaurants&apos;: 1},
 {&apos;Restaurants&apos;: 1, &apos;Pizza&apos;: 1, &apos;Italian&apos;: 1},
 {&apos;Dog Parks&apos;: 1, &apos;Parks&apos;: 1, &apos;Active Life&apos;: 1}]</code></pre>
<p>We can now create a linear regression model with <strong>categories_dict</strong> included
in the feature list. A coefficient is added for each key encountered in the
input data. If the test data contains keys that were not present during
training, they are silently ignored.</p><pre><code class="lang-python"><span class="hljs-comment"># Create a model with dictionary features.</span>
model = tc.linear_regression.create(train_data, target=<span class="hljs-string">&apos;stars&apos;</span>,
                                    features = [<span class="hljs-string">&apos;user_avg_stars&apos;</span>,
                                                <span class="hljs-string">&apos;business_avg_stars&apos;</span>,
                                                <span class="hljs-string">&apos;user_review_count&apos;</span>,
                                                <span class="hljs-string">&apos;business_review_count&apos;</span>,
                                                <span class="hljs-string">&apos;categories_dict&apos;</span>])

<span class="hljs-comment"># Number of feature columns</span>
print(<span class="hljs-string">&quot;Number of features          : %s&quot;</span> % model[<span class="hljs-string">&apos;num_features&apos;</span>])

<span class="hljs-comment"># Number of features (including expanded lists and dictionaries)</span>
print(<span class="hljs-string">&quot;Number of unpacked features : %s&quot;</span> % model[<span class="hljs-string">&apos;num_unpacked_features&apos;</span>])

<span class="hljs-comment"># Number of coefficients in the model</span>
print(<span class="hljs-string">&quot;Number of coefficients      : %s&quot;</span> % model[<span class="hljs-string">&apos;num_coefficients&apos;</span>])

<span class="hljs-comment"># A coefficient is included for each key in the dictionary</span>
print(model[<span class="hljs-string">&apos;coefficients&apos;</span>])</code></pre>
<pre><code class="lang-no-highlight">Number of features          : 5
Number of unpacked features : 511
Number of coefficients      : 512

+-----------------------+--------------------+--------------------+
|          name         |       index        |       value        |
+-----------------------+--------------------+--------------------+
|      (intercept)      |        None        |   0.872679609626   |
|     user_avg_stars    |        None        |   0.415478142682   |
|   business_avg_stars  |        None        |   0.363118585079   |
|   user_review_count   |        None        | -1.13051967735e-05 |
| business_review_count |        None        | 0.000205358202417  |
|    categories_dict    | Breakfast &amp; Brunch |  -0.120010958039   |
|    categories_dict    |    Restaurants     |   0.271655570815   |
|    categories_dict    |   Middle Eastern   |  -0.229361372902   |
|    categories_dict    |     Dog Parks      |  -0.509799508435   |
|    categories_dict    |       Parks        |  -0.0565527745702  |
|          ...          |        ...         |        ...         |
+-----------------------+--------------------+--------------------+
[512 rows x 3 columns]
Note: Only the head of the SFrame is printed.
You can use print_rows(num_rows=m, num_columns=n) to print more rows and columns.</code></pre>
<h6 id="-list-features"><a name="-list-features" class="plugin-anchor" href="#-list-features"><i class="fa fa-link" aria-hidden="true"></i></a><a name="list-features"> </a> List features</h6><p>Turi Create can also handle list of numerical values as features without
preprocessing. The following illustration shows that the numeric-list feature
is equivalent to adding several columns for each individual feature. This is
especially useful for image data where the number of features generated are
large and may not have natural interpretations. The following figure
illustrates this idea.</p><p><a href="images/supervised-learning-list-variables.png"><img alt="List variable summary" src="images/supervised-learning-list-variables.png" style="max-width: 70%; margin-left: 15%;"></a></p><p>As an example, we convert the <strong>votes</strong> (which stores the number of <em>cool</em>,
<em>funny</em>, and <em>useful</em> votes for each review) column into a list of features for
each vote type.</p><pre><code class="lang-python"><span class="hljs-keyword">from</span> array <span class="hljs-keyword">import</span> array

<span class="hljs-comment"># List of features</span>
train_data[<span class="hljs-string">&apos;votes_list&apos;</span>] = train_data[<span class="hljs-string">&apos;votes&apos;</span>].apply(<span class="hljs-keyword">lambda</span> x: x.values())
print(train_data[<span class="hljs-string">&apos;votes_list&apos;</span>].head(<span class="hljs-number">3</span>))</code></pre>
<pre><code class="lang-no-highlight">[array(&apos;d&apos;, [0.0, 5.0, 2.0]),
 array(&apos;d&apos;, [0.0, 0.0, 0.0]),
 array(&apos;d&apos;, [0.0, 2.0, 1.0])]</code></pre>
<p><strong>Notice</strong> that the SArray of numeric lists must be of dtype <strong>array</strong> and the
array in each row must be <strong>of the same length</strong>. The <code>astype()</code> function of
the SArray can help convert your data from type <code>array</code> to <code>list</code>.</p><pre><code class="lang-python"><span class="hljs-comment"># Create a model with numeric-list features.</span>
model = tc.linear_regression.create(train_data, target=<span class="hljs-string">&apos;stars&apos;</span>,
                                    features = [<span class="hljs-string">&apos;user_avg_stars&apos;</span>,
                                                <span class="hljs-string">&apos;business_avg_stars&apos;</span>,
                                                <span class="hljs-string">&apos;user_review_count&apos;</span>,
                                                <span class="hljs-string">&apos;business_review_count&apos;</span>,
                                                <span class="hljs-string">&apos;votes_list&apos;</span>])


<span class="hljs-comment"># Number of feature columns</span>
print(<span class="hljs-string">&quot;Number of features          : %s&quot;</span> % model[<span class="hljs-string">&apos;num_features&apos;</span>])

<span class="hljs-comment"># Number of features (including expanded lists and dictionaries)</span>
print(<span class="hljs-string">&quot;Number of unpacked features : %s&quot;</span> % model[<span class="hljs-string">&apos;num_unpacked_features&apos;</span>])

<span class="hljs-comment"># Number of coefficients in the model</span>
print(<span class="hljs-string">&quot;Number of coefficients      : %s&quot;</span> % model[<span class="hljs-string">&apos;num_coefficients&apos;</span>])

<span class="hljs-comment"># A coefficient is included for each index in the list</span>
print(model[<span class="hljs-string">&apos;coefficients&apos;</span>])</code></pre>
<pre><code class="lang-no-highlight">Number of features          : 5
Number of unpacked features : 7
Number of coefficients      : 8

+-----------------------+-------+-------------------+
|          name         | index |       value       |
+-----------------------+-------+-------------------+
|      (intercept)      |  None |   -2.02163219079  |
|     user_avg_stars    |  None |   0.792122828319  |
|   business_avg_stars  |  None |   0.756871316569  |
|   user_review_count   |  None | 3.46394815858e-06 |
| business_review_count |  None | 7.55781795366e-05 |
|       votes_list      |   0   |  -0.0919094290658 |
|       votes_list      |   1   |  -0.113808771262  |
|       votes_list      |   2   |   0.201216924886  |
+-----------------------+-------+-------------------+
[8 rows x 3 columns]</code></pre>
<h6 id="feature-rescaling"><a name="feature-rescaling" class="plugin-anchor" href="#feature-rescaling"><i class="fa fa-link" aria-hidden="true"></i></a><a name="feature-rescaling"> </a>Feature rescaling</h6><p>Feature rescaling is the process of scaling individual features to be of the
same scale. This process is particularly useful when features vary widely in
their ranges. It is well known that <strong>feature rescaling can make an enormous
impact on accuracy</strong>. By default, Turi Create rescales all the features to
make sure that they have the same L2-norm.  The data is <strong>not centered</strong> to
make each column of mean zero.  Categorical features, lists, and sparse
features (dictionaries), are also rescaled columnwise. The feature rescaling
can be disabled (<strong>only recommended for advanced users</strong>) by setting
<code>feature_rescaling = False</code>. The <strong>coefficients are scaled back to the
original scale of the problem</strong>.</p><pre><code class="lang-python">model = tc.linear_regression.create(train_data, target=<span class="hljs-string">&apos;stars&apos;</span>,
                                    features = [<span class="hljs-string">&apos;user_avg_stars&apos;</span>,
                                                <span class="hljs-string">&apos;business_avg_stars&apos;</span>,
                                                <span class="hljs-string">&apos;user_review_count&apos;</span>,
                                                <span class="hljs-string">&apos;business_review_count&apos;</span>],
                                    feature_rescaling = <span class="hljs-keyword">False</span>)</code></pre>
<h6 id="choosing-the-solver"><a name="choosing-the-solver" class="plugin-anchor" href="#choosing-the-solver"><i class="fa fa-link" aria-hidden="true"></i></a><a name="choosing-the-solver"> </a>Choosing the solver</h6><p>The optimization used to create the model is automatically picked based on the input data from a carefully engineered collection
of methods. The newton
method works best for datasets with plenty of examples and few features (long
datasets). Limited memory BFGS (<code>lbfgs</code>) is a robust solver for wide datasets
(i.e datasets with many coefficients). <code>fista</code> is the default solver for
L1-regularized linear regression. Gradient-descent (GD) is another well tuned
method that can work really well on L1-regularized problems. The <strong>solvers are
all automatically tuned</strong> and the <strong>default options should function well</strong>.
Solver options can, however, be changed.  In this example, we will increase
<code>max_iterations</code> to 20 iterations. This is useful when
<code>model[&apos;solver_status&apos;]</code> is <code>TERMINATED: Iteration limit reached</code> and the
accuracy of the model is not at a desired level.</p><pre><code class="lang-python"><span class="hljs-comment"># Provide solver options in a dictionary</span>
model = tc.linear_regression.create(train_data, target=<span class="hljs-string">&apos;stars&apos;</span>,
                                    features = [<span class="hljs-string">&apos;user_id&apos;</span>,
                                                <span class="hljs-string">&apos;business_id&apos;</span>,
                                                <span class="hljs-string">&apos;user_avg_stars&apos;</span>,
                                                <span class="hljs-string">&apos;business_avg_stars&apos;</span>],
                                    solver = <span class="hljs-string">&apos;lbfgs&apos;</span>,
                                    max_iterations = <span class="hljs-number">20</span>)</code></pre>
<p><strong> What happens when the default solver fails?</strong></p><p>Whenever you have convergence trouble and the number of features is &lt; 5000, then
<code>solver</code>=<code>newton</code> is a good choice. The Newton method is one of the most
stable optimization methods and works quite well if you have few coefficients.
The downside of the Newton method is its large computational complexity per-
iteration.</p><p><strong>Solver options guide</strong></p><p>Most solvers are all automatically tuned and the default options should function
well. Changing the default settings may help in some cases.</p><ul><li><code>step_size</code>: The starting step size to use for the <code>fista</code> and <code>gd</code>
solvers. The default is set to 1.0, this is an aggressive setting. If the first
iteration is taking a considerable amount of time, then reducing the step size
may speed up model training. If the step size of 1.0 is accepted in the first
iteration, then consider increasing this step size to a more aggressive value.
</li></ul>
<ul><li><code>max_iterations</code> : The maximum number of passes through the data allowed.
Increasing his can result in a more accurately trained model. Consider
increasing this (the default value is 10) if the training accuracy is low and
the <em>Grad-Norm</em> in the display is large.
</li></ul>
<ul><li><code>convergence_threshold</code>: Convergence is tested using variation in the training
objective. The variation in the training objective is calculated by dividing the
difference between the objective values between two steps. Consider reducing this
below the default value (0.01) for a better training data fit. Beware of
<a href="http://en.wikipedia.org/wiki/Overfitting" target="_blank">overfitting</a> (i.e a model that works well only on the training data) if this
parameter is set to a very low value.
</li></ul>
<ul><li><code>lbfgs_memory_level</code>: The L-BFGS algorithm keeps track of gradient
information from the previous <code>lbfgs_memory_level</code> iterations. The storage
requirement for each of these gradients is the <code>num_coefficients</code> in the
problem. Increasing the <code>lbfgs_memory_level</code>can help improve the quality of
the model trained at the cost of more memory. Setting this to more than
<code>max_iterations</code> has the same effect as setting it to <code>max_iterations</code>.
</li></ul>
<h6 id="making-predictions-with-missing-data"><a name="making-predictions-with-missing-data" class="plugin-anchor" href="#making-predictions-with-missing-data"><i class="fa fa-link" aria-hidden="true"></i></a>Making predictions with missing data</h6><p>Once the model is created and ready to make predictions, it is quite common
that the input data to make predictions on are noisy. Turi Create can
recognize the following types of missing data (stored as <strong>None</strong>). Note that
the following options only apply to <strong>missing values during prediction or
evaluation</strong>. Missing values during model creation raise an error.</p><ul><li><strong>Missing values in individual features</strong>: Individual features including
numerical, categorical, list of numeric, and dictionary features may contain
missing data. The option <code>missing_value_action</code> determines the way in which
these features are handled. The <strong>default value</strong> value is
<code>missing_value_action=&apos;impute&apos;</code> which imputes each of the features to the mean
value observed during training. Setting <code>missing_value_action=&apos;error&apos;</code> throws
an error if any missing values are encountered during prediction.
</li></ul>
<ul><li><strong>Missing feature columns</strong>: Sometimes, an entire column is missing while
making predictions. In this case, <code>missing_value_action=&apos;impute&apos;</code> imputes the
mean value observed during training for each row in the input data. Again,
setting <code>missing_value_action=&apos;error&apos;</code> throws an error if an entire feature
column is missing during prediction.
</li></ul>
<ul><li><strong>New categories in categorical features</strong>: New categories are often observed
during predict time. These new categories are treated to be the same as the
reference category thus having no effect on the model prediction.
</li></ul>
<ul><li><strong>New keys in dictionary features</strong>: New keys in dictionary features during
predict time are silently ignored and do not effect the prediction made.
</li></ul>
<pre><code class="lang-python"><span class="hljs-comment"># Create a model with categorical and dictionary features.</span>
model = tc.linear_regression.create(train_data, target=<span class="hljs-string">&apos;stars&apos;</span>,
                                    features = [<span class="hljs-string">&apos;user_avg_stars&apos;</span>,
                                                <span class="hljs-string">&apos;business_avg_stars&apos;</span>,
                                                <span class="hljs-string">&apos;user_review_count&apos;</span>,
                                                <span class="hljs-string">&apos;business_review_count&apos;</span>,
                                                <span class="hljs-string">&apos;city&apos;</span>,
                                                <span class="hljs-string">&apos;categories_dict&apos;</span>])

<span class="hljs-comment"># An SFrame with a single row with missing values in the &apos;user_avg_stars&apos;</span>
<span class="hljs-comment"># predict() will impute the entire feature to the mean value observed during training</span>
new_data = tc.SFrame({<span class="hljs-string">&apos;user_avg_stars&apos;</span>: [<span class="hljs-keyword">None</span>],
                      <span class="hljs-string">&apos;business_avg_stars&apos;</span>: [<span class="hljs-number">30.0</span>],
                      <span class="hljs-string">&apos;user_review_count&apos;</span>: [<span class="hljs-number">10</span>],
                      <span class="hljs-string">&apos;business_review_count&apos;</span>: [<span class="hljs-number">20</span>],
                       <span class="hljs-string">&apos;city&apos;</span>: [<span class="hljs-string">&apos;Tuscon&apos;</span>],
                       <span class="hljs-string">&apos;categories_dict&apos;</span>: [{<span class="hljs-string">&apos;Pizza&apos;</span>: <span class="hljs-number">1</span>}]
                      })
prediction = model.predict(new_data)
print(prediction)

<span class="hljs-comment"># An SFrame without the &apos;user_avg_stars&apos; feature. predict() will impute the</span>
<span class="hljs-comment"># entire feature to the mean value observed during training.</span>
new_data = tc.SFrame({<span class="hljs-string">&apos;business_avg_stars&apos;</span>: [<span class="hljs-number">30.0</span>],
                      <span class="hljs-string">&apos;user_review_count&apos;</span>: [<span class="hljs-number">10</span>],
                      <span class="hljs-string">&apos;business_review_count&apos;</span>: [<span class="hljs-number">20</span>],
                       <span class="hljs-string">&apos;city&apos;</span>: [<span class="hljs-string">&apos;Tuscon&apos;</span>],
                       <span class="hljs-string">&apos;categories_dict&apos;</span>: [{<span class="hljs-string">&apos;Pizza&apos;</span>: <span class="hljs-number">1</span>}]
                      })
prediction = model.predict(new_data)</code></pre>
<h6 id="regularizing-models-lasso-ridge-and-elastic-net-regression"><a name="regularizing-models-lasso-ridge-and-elastic-net-regression" class="plugin-anchor" href="#regularizing-models-lasso-ridge-and-elastic-net-regression"><i class="fa fa-link" aria-hidden="true"></i></a><a name="regularizing-models"></a> Regularizing Models (Lasso, Ridge, and Elastic Net regression)</h6><p>Regularization is the process of using problem structure to solve ill-posed
problems or to prevent overfitting. The structure is imposed by adding a penalty
term to the objective function. The linear regression module supports L1 and L2
regularization, which are added to the loss function.</p><p>As discussed above, the composite objective being optimized for is the
following:
<script type="math/tex; mode=display">


```
\min_{\theta} \sum_{i = 1}^{n} (\theta^Tx - y_i)^2 + \lambda_1 ||\theta||_1
```

* \lambda\_2 \|\|\theta\|\|^2\_2
  </script></p><p>where <script type="math/tex; ">\lambda_1</script> is the <code>l1_penalty</code> and <script type="math/tex; ">\lambda_2</script> is the <code>l2_penalty</code>.</p><pre><code class="lang-python"><span class="hljs-comment"># Lasso</span>
model = tc.linear_regression.create(train_data, target=<span class="hljs-string">&apos;stars&apos;</span>,
                                    features = [<span class="hljs-string">&apos;user_avg_stars&apos;</span>,
                                                <span class="hljs-string">&apos;business_avg_stars&apos;</span>,
                                                <span class="hljs-string">&apos;user_review_count&apos;</span>,
                                                <span class="hljs-string">&apos;business_review_count&apos;</span>],
                                    l1_penalty = <span class="hljs-number">1.0</span>,
                                    l2_penalty = <span class="hljs-number">0.0</span>)

<span class="hljs-comment"># Ridge regression</span>
model = tc.linear_regression.create(train_data, target=<span class="hljs-string">&apos;stars&apos;</span>,
                                    features = [<span class="hljs-string">&apos;user_avg_stars&apos;</span>,
                                                <span class="hljs-string">&apos;business_avg_stars&apos;</span>,
                                                <span class="hljs-string">&apos;user_review_count&apos;</span>,
                                                <span class="hljs-string">&apos;business_review_count&apos;</span>],
                                    l2_penalty = <span class="hljs-number">1.0</span>)

<span class="hljs-comment"># Elastic net regression</span>
model = tc.linear_regression.create(train_data, target=<span class="hljs-string">&apos;stars&apos;</span>,
                                    features = [<span class="hljs-string">&apos;user_avg_stars&apos;</span>,
                                                <span class="hljs-string">&apos;business_avg_stars&apos;</span>,
                                                <span class="hljs-string">&apos;user_review_count&apos;</span>,
                                                <span class="hljs-string">&apos;business_review_count&apos;</span>],
                                    l1_penalty = <span class="hljs-number">1.0</span>,
                                    l2_penalty = <span class="hljs-number">1.0</span>)</code></pre>

                                
                                </section>
                            
    </div>
    <div class="search-results">
        <div class="has-results">
            
            <h1 class="search-results-title"><span class='search-results-count'></span> results matching "<span class='search-query'></span>"</h1>
            <ul class="search-results-list"></ul>
            
        </div>
        <div class="no-results">
            
            <h1 class="search-results-title">No results matching "<span class='search-query'></span>"</h1>
            
        </div>
    </div>
</div>

                        </div>
                    </div>
                
            </div>

            
                
                <a href="decision_tree_regression.html" class="navigation navigation-prev " aria-label="Previous page: Decision Tree Regression">
                    <i class="fa fa-angle-left"></i>
                </a>
                
                
                <a href="random_forest_regression.html" class="navigation navigation-next " aria-label="Next page: Random Forest Regression">
                    <i class="fa fa-angle-right"></i>
                </a>
                
            
        
    </div>

    <script>
        var gitbook = gitbook || [];
        gitbook.push(function() {
            gitbook.page.hasChanged({"page":{"title":"Linear Regression","level":"1.4.5.3","depth":3,"next":{"title":"Random Forest Regression","level":"1.4.5.4","depth":3,"path":"supervised-learning/random_forest_regression.md","ref":"supervised-learning/random_forest_regression.md","articles":[]},"previous":{"title":"Decision Tree Regression","level":"1.4.5.2","depth":3,"path":"supervised-learning/decision_tree_regression.md","ref":"supervised-learning/decision_tree_regression.md","articles":[]},"dir":"ltr"},"config":{"gitbook":"3.2.0","theme":"default","variables":{},"plugins":["collapsible-menu@1.0.2","anchors@0.5.0","mathjax"],"pluginsConfig":{"collapsible-menu":{},"search":{},"lunr":{"maxIndexSize":1000000,"ignoreSpecialCharacters":false},"fontsettings":{"theme":"white","family":"sans","size":2},"fontSettings":{"theme":"white","family":"sans","size":2},"highlight":{},"mathjax":{"forceSVG":false,"version":"2.6-latest"},"sharing":{"facebook":true,"twitter":true,"google":false,"weibo":false,"instapaper":false,"vk":false,"all":["facebook","google","twitter","weibo","instapaper"]},"theme-default":{"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"},"showLevel":false},"anchors":{}},"structure":{"langs":"LANGS.md","readme":"README.md","glossary":"GLOSSARY.md","summary":"SUMMARY.md"},"pdf":{"pageNumbers":true,"fontSize":12,"fontFamily":"Arial","paperSize":"a4","chapterMark":"pagebreak","pageBreaksBefore":"/","margin":{"right":62,"left":62,"top":56,"bottom":56}},"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"}},"file":{"path":"supervised-learning/linear-regression.md","mtime":"2020-05-01T16:47:49.139Z","type":"markdown"},"gitbook":{"version":"3.2.0","time":"2020-05-21T01:09:56.706Z"},"basePath":"..","book":{"language":""}});
        });
    </script>
</div>

        
    <script src="../gitbook/gitbook.js"></script>
    <script src="../gitbook/theme.js"></script>
    
        
        <script src="../gitbook/gitbook-plugin-collapsible-menu/plugin.js"></script>
        
    
        
        <script src="https://cdn.mathjax.org/mathjax/2.6-latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-mathjax/plugin.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-search/search-engine.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-search/search.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-lunr/lunr.min.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-lunr/search-lunr.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-sharing/buttons.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-fontsettings/fontsettings.js"></script>
        
    

    </body>
</html>

