

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>turicreate.linear_regression.create &mdash; Turi Create API 6.3 documentation</title>
  

  
  
    <link rel="shortcut icon" href="../_static/favicon.ico"/>
  

  
  <link href='https://fonts.googleapis.com/css?family=Lato:400,700,400italic,700italic|Roboto+Slab:400,700|Inconsolata:400,700&subset=latin,cyrillic' rel='stylesheet' type='text/css'>

  
  
    

  

  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />

  
        <link rel="index" title="Index"
              href="../genindex.html"/>
        <link rel="search" title="Search" href="../search.html"/>
    <link rel="top" title="Turi Create API 6.3 documentation" href="../index.html"/>
        <link rel="up" title="regression" href="../turicreate.toolkits.regression.html"/>
        <link rel="next" title="turicreate.linear_regression.LinearRegression" href="turicreate.linear_regression.LinearRegression.html"/>
        <link rel="prev" title="turicreate.boosted_trees_regression.BoostedTreesRegression" href="turicreate.boosted_trees_regression.BoostedTreesRegression.html"/> 

  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/modernizr/2.6.2/modernizr.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-nav-search">
        
          <a href="../index.html" class="fa fa-home"> Turi Create API</a>
        
        
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
        
          
          
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../turicreate.data_structures.html">Data</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../turicreate.data_structures.html#id1">Data Structures</a></li>
<li class="toctree-l2"><a class="reference internal" href="../turicreate.data_structures.html#data-types">Data Types</a></li>
<li class="toctree-l2"><a class="reference internal" href="../turicreate.data_structures.html#utilities">Utilities</a></li>
</ul>
</li>
<li class="toctree-l1 current"><a class="reference internal" href="../turicreate.toolkits.html">Modelling</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../turicreate.toolkits.html#applications">Applications</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../turicreate.toolkits.html#essentials">Essentials</a></li>
<li class="toctree-l2"><a class="reference internal" href="../turicreate.toolkits.html#utilities">Utilities</a></li>
</ul>
</li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../turicreate.visualization.html">Visualization</a></li>
<li class="toctree-l1"><a class="reference internal" href="../turicreate.utils.html">Configuration</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../turicreate.utils.html#logging">logging</a></li>
<li class="toctree-l2"><a class="reference internal" href="../turicreate.utils.html#runtime">runtime</a></li>
</ul>
</li>
</ul>

          
        
      </div>
      &nbsp;
      
        <span class="powered-by">
          <a id="footer-logo" href="https://github.com/apple/turicreate"><img src="../_static/tc_logo_white.png"/></a>
        </span>
      
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="../index.html">Turi Create API</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../index.html">Docs</a> &raquo;</li>
      
          <li><a href="../turicreate.toolkits.html">Modelling</a> &raquo;</li>
      
          <li><a href="../turicreate.toolkits.regression.html"><code class="docutils literal"><span class="pre">regression</span></code></a> &raquo;</li>
      
    <li>turicreate.linear_regression.create</li>
      <li class="wy-breadcrumbs-aside">
        
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document">
            
  <div class="section" id="turicreate-linear-regression-create">
<h1>turicreate.linear_regression.create<a class="headerlink" href="#turicreate-linear-regression-create" title="Permalink to this headline">¶</a></h1>
<dl class="function">
<dt id="turicreate.linear_regression.create">
<code class="descclassname">turicreate.linear_regression.</code><code class="descname">create</code><span class="sig-paren">(</span><em>dataset</em>, <em>target</em>, <em>features=None</em>, <em>l2_penalty=0.01</em>, <em>l1_penalty=0.0</em>, <em>solver='auto'</em>, <em>feature_rescaling=True</em>, <em>convergence_threshold=0.01</em>, <em>step_size=1.0</em>, <em>lbfgs_memory_level=11</em>, <em>max_iterations=10</em>, <em>validation_set='auto'</em>, <em>verbose=True</em><span class="sig-paren">)</span><a class="headerlink" href="#turicreate.linear_regression.create" title="Permalink to this definition">¶</a></dt>
<dd><p>Create a <a class="reference internal" href="turicreate.linear_regression.LinearRegression.html#turicreate.linear_regression.LinearRegression" title="turicreate.linear_regression.LinearRegression"><code class="xref py py-class docutils literal"><span class="pre">LinearRegression</span></code></a> to
predict a scalar target variable as a linear function of one or more
features. In addition to standard numeric and categorical types, features
can also be extracted automatically from list- or dictionary-type SFrame
columns.</p>
<p>The linear regression module can be used for ridge regression, Lasso, and
elastic net regression (see References for more detail on these methods). By
default, this model has an l2 regularization weight of 0.01.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first docutils">
<dt><strong>dataset</strong> <span class="classifier-delimiter">:</span> <span class="classifier">SFrame</span></dt>
<dd><p class="first last">The dataset to use for training the model.</p>
</dd>
<dt><strong>target</strong> <span class="classifier-delimiter">:</span> <span class="classifier">string</span></dt>
<dd><p class="first last">Name of the column containing the target variable.</p>
</dd>
<dt><strong>features</strong> <span class="classifier-delimiter">:</span> <span class="classifier">list[string], optional</span></dt>
<dd><p class="first">Names of the columns containing features. ‘None’ (the default) indicates
that all columns except the target variable should be used as features.</p>
<p>The features are columns in the input SFrame that can be of the
following types:</p>
<ul class="simple">
<li><em>Numeric</em>: values of numeric type integer or float.</li>
<li><em>Categorical</em>: values of type string.</li>
<li><em>Array</em>: list of numeric (integer or float) values. Each list element
is treated as a separate feature in the model.</li>
<li><em>Dictionary</em>: key-value pairs with numeric (integer or float) values
Each key of a dictionary is treated as a separate feature and the
value in the dictionary corresponds to the value of the feature.
Dictionaries are ideal for representing sparse data.</li>
</ul>
<p class="last">Columns of type <em>list</em> are not supported. Convert such feature
columns to type array if all entries in the list are of numeric
types. If the lists contain data of mixed types, separate
them out into different columns.</p>
</dd>
<dt><strong>l2_penalty</strong> <span class="classifier-delimiter">:</span> <span class="classifier">float, optional</span></dt>
<dd><p class="first last">Weight on the l2-regularizer of the model. The larger this weight, the
more the model coefficients shrink toward 0. This introduces bias into
the model but decreases variance, potentially leading to better
predictions. The default value is 0.01; setting this parameter to 0
corresponds to unregularized linear regression. See the ridge
regression reference for more detail.</p>
</dd>
<dt><strong>l1_penalty</strong> <span class="classifier-delimiter">:</span> <span class="classifier">float, optional</span></dt>
<dd><p class="first last">Weight on l1 regularization of the model. Like the l2 penalty, the
higher the l1 penalty, the more the estimated coefficients shrink toward
0. The l1 penalty, however, completely zeros out sufficiently small
coefficients, automatically indicating features that are not useful for
the model. The default weight of 0 prevents any features from being
discarded. See the LASSO regression reference for more detail.</p>
</dd>
<dt><strong>solver</strong> <span class="classifier-delimiter">:</span> <span class="classifier">string, optional</span></dt>
<dd><p class="first">Solver to use for training the model. See the references for more detail
on each solver.</p>
<ul class="simple">
<li><em>auto (default)</em>: automatically chooses the best solver for the data
and model parameters.</li>
<li><em>newton</em>: Newton-Raphson</li>
<li><em>lbfgs</em>: limited memory BFGS</li>
<li><em>fista</em>: accelerated gradient descent</li>
</ul>
<p>The model is trained using a carefully engineered collection of methods
that are automatically picked based on the input data. The <code class="docutils literal"><span class="pre">newton</span></code>
method  works best for datasets with plenty of examples and few features
(long datasets). Limited memory BFGS (<code class="docutils literal"><span class="pre">lbfgs</span></code>) is a robust solver for
wide datasets (i.e datasets with many coefficients).  <code class="docutils literal"><span class="pre">fista</span></code> is the
default solver for l1-regularized linear regression.  The solvers are
all automatically tuned and the default options should function well.
See the solver options guide for setting additional parameters for each
of the solvers.</p>
<p class="last">See the user guide for additional details on how the solver is chosen.</p>
</dd>
<dt><strong>feature_rescaling</strong> <span class="classifier-delimiter">:</span> <span class="classifier">boolean, optional</span></dt>
<dd><p class="first last">Feature rescaling is an important pre-processing step that ensures that
all features are on the same scale. An l2-norm rescaling is performed
to make sure that all features are of the same norm. Categorical
features are also rescaled by rescaling the dummy variables that are
used to represent them. The coefficients are returned in original scale
of the problem. This process is particularly useful when features
vary widely in their ranges.</p>
</dd>
<dt><strong>validation_set</strong> <span class="classifier-delimiter">:</span> <span class="classifier">SFrame, optional</span></dt>
<dd><p class="first last">A dataset for monitoring the model’s generalization performance.
For each row of the progress table, the chosen metrics are computed
for both the provided training dataset and the validation_set. The
format of this SFrame must be the same as the training set.
By default this argument is set to ‘auto’ and a validation set is
automatically sampled and used for progress printing. If
validation_set is set to None, then no additional metrics
are computed. The default value is ‘auto’.</p>
</dd>
<dt><strong>convergence_threshold</strong> <span class="classifier-delimiter">:</span> <span class="classifier">float, optional</span></dt>
<dd><p class="first last">Convergence is tested using variation in the training objective. The
variation in the training objective is calculated using the difference
between the objective values between two steps. Consider reducing this
below the default value (0.01) for a more accurately trained model.
Beware of overfitting (i.e a model that works well only on the training
data) if this parameter is set to a very low value.</p>
</dd>
<dt><strong>lbfgs_memory_level</strong> <span class="classifier-delimiter">:</span> <span class="classifier">int, optional</span></dt>
<dd><p class="first last">The L-BFGS algorithm keeps track of gradient information from the
previous <code class="docutils literal"><span class="pre">lbfgs_memory_level</span></code> iterations. The storage requirement for
each of these gradients is the <code class="docutils literal"><span class="pre">num_coefficients</span></code> in the problem.
Increasing the <code class="docutils literal"><span class="pre">lbfgs_memory_level</span></code> can help improve the quality of
the model trained. Setting this to more than <code class="docutils literal"><span class="pre">max_iterations</span></code> has the
same effect as setting it to <code class="docutils literal"><span class="pre">max_iterations</span></code>.</p>
</dd>
<dt><strong>max_iterations</strong> <span class="classifier-delimiter">:</span> <span class="classifier">int, optional</span></dt>
<dd><p class="first last">The maximum number of allowed passes through the data. More passes over
the data can result in a more accurately trained model. Consider
increasing this (the default value is 10) if the training accuracy is
low and the <em>Grad-Norm</em> in the display is large.</p>
</dd>
<dt><strong>step_size</strong> <span class="classifier-delimiter">:</span> <span class="classifier">float, optional (fista only)</span></dt>
<dd><p class="first last">The starting step size to use for the <code class="docutils literal"><span class="pre">fista</span></code> and <code class="docutils literal"><span class="pre">gd</span></code> solvers. The
default is set to 1.0, this is an aggressive setting. If the first
iteration takes a considerable amount of time, reducing this parameter
may speed up model training.</p>
</dd>
<dt><strong>verbose</strong> <span class="classifier-delimiter">:</span> <span class="classifier">bool, optional</span></dt>
<dd><p class="first last">If True, print progress updates.</p>
</dd>
</dl>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>out</strong> <span class="classifier-delimiter">:</span> <span class="classifier">LinearRegression</span></dt>
<dd><p class="first last">A trained model of type
<a class="reference internal" href="turicreate.linear_regression.LinearRegression.html#turicreate.linear_regression.LinearRegression" title="turicreate.linear_regression.LinearRegression"><code class="xref py py-class docutils literal"><span class="pre">LinearRegression</span></code></a>.</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<dl class="last docutils">
<dt><a class="reference internal" href="turicreate.linear_regression.LinearRegression.html#turicreate.linear_regression.LinearRegression" title="turicreate.linear_regression.LinearRegression"><code class="xref py py-obj docutils literal"><span class="pre">LinearRegression</span></code></a>, <a class="reference internal" href="turicreate.boosted_trees_regression.BoostedTreesRegression.html#turicreate.boosted_trees_regression.BoostedTreesRegression" title="turicreate.boosted_trees_regression.BoostedTreesRegression"><code class="xref py py-obj docutils literal"><span class="pre">turicreate.boosted_trees_regression.BoostedTreesRegression</span></code></a>, <a class="reference internal" href="turicreate.regression.create.html#turicreate.regression.create" title="turicreate.regression.create"><code class="xref py py-obj docutils literal"><span class="pre">turicreate.regression.create</span></code></a></dt>
<dd></dd>
</dl>
</div>
<p class="rubric">Notes</p>
<ul class="simple">
<li>Categorical variables are encoded by creating dummy variables. For a
variable with <span class="math">\(K\)</span> categories, the encoding creates <span class="math">\(K-1\)</span> dummy
variables, while the first category encountered in the data is used as the
baseline.</li>
<li>For prediction and evaluation of linear regression models with sparse
dictionary inputs, new keys/columns that were not seen during training
are silently ignored.</li>
<li>Any ‘None’ values in the data will result in an error being thrown.</li>
<li>A constant term is automatically added for the model intercept. This term
is not regularized.</li>
<li>Standard errors on coefficients are only available when <cite>solver=newton</cite>
or when the default <cite>auto</cite> solver option chooses the newton method and if
the number of examples in the training data is more than the number of
coefficients. If standard errors cannot be estimated, a column of <cite>None</cite>
values are returned.</li>
</ul>
<p class="rubric">References</p>
<ul class="simple">
<li>Hoerl, A.E. and Kennard, R.W. (1970) <a class="reference external" href="http://amstat.tandfonline.com/doi/abs/10.1080/00401706.1970.10488634">Ridge regression: Biased Estimation
for Nonorthogonal Problems</a>.
Technometrics 12(1) pp.55-67</li>
<li>Tibshirani, R. (1996) <a class="reference external" href="http://www.jstor.org/discover/10.2307/2346178?uid=3739256&amp;uid=2&amp;uid=4&amp;sid=21104169934983">Regression Shrinkage and Selection via the Lasso</a>. Journal of the Royal Statistical Society. Series B
(Methodological) 58(1) pp.267-288.</li>
<li>Zhu, C., et al. (1997) <a class="reference external" href="https://dl.acm.org/citation.cfm?id=279236">Algorithm 778: L-BFGS-B: Fortran subroutines for
large-scale bound-constrained optimization</a>. ACM Transactions on
Mathematical Software 23(4) pp.550-560.</li>
<li>Barzilai, J. and Borwein, J. <a class="reference external" href="http://imajna.oxfordjournals.org/content/8/1/141.short">Two-Point Step Size Gradient Methods</a>. IMA Journal of
Numerical Analysis 8(1) pp.141-148.</li>
<li>Beck, A. and Teboulle, M. (2009) <a class="reference external" href="http://epubs.siam.org/doi/abs/10.1137/080716542">A Fast Iterative Shrinkage-Thresholding
Algorithm for Linear Inverse Problems</a>. SIAM Journal on
Imaging Sciences 2(1) pp.183-202.</li>
<li>Zhang, T. (2004) <a class="reference external" href="https://dl.acm.org/citation.cfm?id=1015332">Solving large scale linear prediction problems using
stochastic gradient descent algorithms</a>. ICML ‘04: Proceedings of
the twenty-first international conference on Machine learning p.116.</li>
</ul>
<p class="rubric">Examples</p>
<p>Given an <a class="reference internal" href="turicreate.SFrame.html#turicreate.SFrame" title="turicreate.SFrame"><code class="xref py py-class docutils literal"><span class="pre">SFrame</span></code></a> <code class="docutils literal"><span class="pre">sf</span></code> with a list of columns
[<code class="docutils literal"><span class="pre">feature_1</span></code> … <code class="docutils literal"><span class="pre">feature_K</span></code>] denoting features and a target column
<code class="docutils literal"><span class="pre">target</span></code>, we can create a
<a class="reference internal" href="turicreate.linear_regression.LinearRegression.html#turicreate.linear_regression.LinearRegression" title="turicreate.linear_regression.LinearRegression"><code class="xref py py-class docutils literal"><span class="pre">LinearRegression</span></code></a> as follows:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span>  <span class="n">turicreate</span><span class="o">.</span><span class="n">SFrame</span><span class="p">(</span><span class="s1">&#39;https://static.turi.com/datasets/regression/houses.csv&#39;</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">model</span> <span class="o">=</span> <span class="n">turicreate</span><span class="o">.</span><span class="n">linear_regression</span><span class="o">.</span><span class="n">create</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">target</span><span class="o">=</span><span class="s1">&#39;price&#39;</span><span class="p">,</span>
<span class="gp">... </span>                                 <span class="n">features</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;bath&#39;</span><span class="p">,</span> <span class="s1">&#39;bedroom&#39;</span><span class="p">,</span> <span class="s1">&#39;size&#39;</span><span class="p">])</span>
</pre></div>
</div>
<p>For ridge regression, we can set the <code class="docutils literal"><span class="pre">l2_penalty</span></code> parameter higher (the
default is 0.01). For Lasso regression, we set the l1_penalty higher, and
for elastic net, we set both to be higher.</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="c1"># Ridge regression</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">model_ridge</span> <span class="o">=</span> <span class="n">turicreate</span><span class="o">.</span><span class="n">linear_regression</span><span class="o">.</span><span class="n">create</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="s1">&#39;price&#39;</span><span class="p">,</span> <span class="n">l2_penalty</span><span class="o">=</span><span class="mf">0.1</span><span class="p">)</span>

<span class="c1"># Lasso</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">model_lasso</span> <span class="o">=</span> <span class="n">turicreate</span><span class="o">.</span><span class="n">linear_regression</span><span class="o">.</span><span class="n">create</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="s1">&#39;price&#39;</span><span class="p">,</span> <span class="n">l2_penalty</span><span class="o">=</span><span class="mf">0.</span><span class="p">,</span>
                                                             <span class="n">l1_penalty</span><span class="o">=</span><span class="mf">1.0</span><span class="p">)</span>

<span class="c1"># Elastic net regression</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">model_enet</span>  <span class="o">=</span> <span class="n">turicreate</span><span class="o">.</span><span class="n">linear_regression</span><span class="o">.</span><span class="n">create</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="s1">&#39;price&#39;</span><span class="p">,</span> <span class="n">l2_penalty</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span>
                                                           <span class="n">l1_penalty</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

</div>


          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="turicreate.linear_regression.LinearRegression.html" class="btn btn-neutral float-right" title="turicreate.linear_regression.LinearRegression">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="turicreate.boosted_trees_regression.BoostedTreesRegression.html" class="btn btn-neutral" title="turicreate.boosted_trees_regression.BoostedTreesRegression"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
      Last updated on May 21, 2020.
    </p>
  </div>
</footer>
        </div>
      </div>

    </section>

  </div>
  

  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../',
            VERSION:'6.3',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  false
        };
    </script>
      <script type="text/javascript" src="../_static/underscore.js"></script>
      <script type="text/javascript" src="../_static/doctools.js"></script>

  

  <script type="text/javascript" src="../_static/js/theme.js"></script>

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>